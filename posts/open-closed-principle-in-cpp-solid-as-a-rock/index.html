<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  Open Closed Principle in C&#43;&#43; | SOLID as a Rock · Vishal Chovatiya
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Vishal Chovatiya">
<meta name="description" content="This is the second part of a five-part article series about SOLID as Rock design principle. The SOLID design principles, when combined together, make it easy for a programmer to craft software that is easy to maintain, reuse &amp; extend. Open-Closed Principle(OCP) is the second principle in this series which I will discuss here with minimalistic example in Modern C&#43;&#43; along with its benefits &amp; generic guideline.
By the way, If you haven&rsquo;t gone through my previous articles on design principles, then below is the quick links:">
<meta name="keywords" content="blog,developer,personal">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Open Closed Principle in C&#43;&#43; | SOLID as a Rock">
  <meta name="twitter:description" content="This is the second part of a five-part article series about SOLID as Rock design principle. The SOLID design principles, when combined together, make it easy for a programmer to craft software that is easy to maintain, reuse &amp; extend. Open-Closed Principle(OCP) is the second principle in this series which I will discuss here with minimalistic example in Modern C&#43;&#43; along with its benefits &amp; generic guideline.
By the way, If you haven’t gone through my previous articles on design principles, then below is the quick links:">

<meta property="og:url" content="http://localhost:1313/posts/open-closed-principle-in-cpp-solid-as-a-rock/">
  <meta property="og:site_name" content="Vishal Chovatiya">
  <meta property="og:title" content="Open Closed Principle in C&#43;&#43; | SOLID as a Rock">
  <meta property="og:description" content="This is the second part of a five-part article series about SOLID as Rock design principle. The SOLID design principles, when combined together, make it easy for a programmer to craft software that is easy to maintain, reuse &amp; extend. Open-Closed Principle(OCP) is the second principle in this series which I will discuss here with minimalistic example in Modern C&#43;&#43; along with its benefits &amp; generic guideline.
By the way, If you haven’t gone through my previous articles on design principles, then below is the quick links:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-04-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-04-07T00:00:00+00:00">




<link rel="canonical" href="http://localhost:1313/posts/open-closed-principle-in-cpp-solid-as-a-rock/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">








 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>




<body class="preload-transitions colorscheme-light">
  

  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      Vishal Chovatiya
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Latest</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/pages/start-here">Start Here</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/cpp/">C/C&#43;&#43;</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/linux-system-programming/">Linux System Programming</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/misc/">Misc</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/open-closed-principle-in-cpp-solid-as-a-rock/">
              Open Closed Principle in C&#43;&#43; | SOLID as a Rock
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2020-04-07T00:00:00Z">
                April 7, 2020
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              8-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/cpp/">Cpp</a>
      <span class="separator">•</span>
    <a href="/categories/design-patterns/">Design-Patterns</a>
      <span class="separator">•</span>
    <a href="/categories/design-principles/">Design-Principles</a>
      <span class="separator">•</span>
    <a href="/categories/software-engineering/">Software-Engineering</a></div>

          
        </div>
      </header>

      <div class="post-content">
        
          <img src="/images/Open-Closed-Principle-in-C-SOLID-as-a-Rock-vishal-chovatiya.webp" alt="Featured image"/>
        
        <p>This is the second part of a five-part article series about SOLID as Rock design principle. The SOLID design principles, when combined together, make it easy for a programmer to craft software that is easy to maintain, reuse &amp; extend. <strong>O</strong>pen-<strong>C</strong>losed <strong>P</strong>rinciple(OCP) is the second principle in this series which I will discuss here with minimalistic example in <a href="/posts/21-new-features-of-modern-cpp-to-use-in-your-project/" >Modern C++</a> along with its benefits &amp; generic guideline.</p>
<p>By the way, If you haven&rsquo;t gone through my previous articles on design principles, then below is the quick links:</p>
<ol>
<li><a href="/posts//single-responsibility-principle-in-cpp-solid-as-a-rock/" ><strong>S</strong>RP – Single Responsibility Principle</a></li>
<li><a href="/posts//open-closed-principle-in-cpp-solid-as-a-rock/" ><strong>O</strong>CP – Open/Closed Principle</a></li>
<li><a href="/posts//liskovs-substitution-principle-in-cpp-solid-as-a-rock/" ><strong>L</strong>SP – Liskov Substitution Principle</a></li>
<li><a href="/posts//interface-segregation-principle-in-cpp-solid-as-a-rock/" ><strong>I</strong>SP – Interface Segregation Principle</a></li>
<li><a href="/posts//dependency-inversion-principle-in-cpp-solid-as-a-rock/" ><strong>D</strong>IP – Dependency Inversion Principle</a></li>
</ol>
<p>The code snippets you see throughout this series of articles are simplified not sophisticated. So you often see me not using keywords like <code>override</code>, <code>final</code>, <code>public</code>(while inheritance) just to make code compact &amp; consumable(most of the time) in single standard screen size. I also prefer <code>struct</code> instead of <code>class</code> just to save line by not writing &ldquo;<code>public:</code>&rdquo; sometimes and also miss <a href="/posts//part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works/" >virtual destructor</a>, constructor, <a href="/posts//all-about-copy-constructor-in-cpp-with-example/" >copy constructor</a>, prefix <code>std::</code>, deleting dynamic memory, intentionally. I also consider myself a pragmatic person who wants to convey an idea in the simplest way possible rather than the standard way or using Jargons.</p>
<p><strong><em>Note:</em></strong></p>
<ul>
<li>If you stumbled here directly, then I would suggest you go through <a href="/posts//what-is-design-pattern/" >What is design pattern?</a> first, even if it is trivial. I believe it will encourage you to explore more on this topic.</li>
<li>All of this code you encounter in this series of articles are compiled using C++20(though I have used <a href="/posts//21-new-features-of-modern-cpp-to-use-in-your-project/" >Modern C++</a> features up to C++17 in most cases). So if you don&rsquo;t have access to the latest compiler you can use <a href="https://wandbox.org/"  class="external-link" target="_blank" rel="noopener">https://wandbox.org/</a> which has preinstalled boost library as well.</li>
</ul>
<h2 id="intent">
  Intent
  <a class="heading-link" href="#intent">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<blockquote>
<p><strong><em>classes should be open for extension, closed for modification</em></strong></p>
</blockquote>
<ul>
<li>This literally means you should be able to extend a classes behaviour, without modifying it. This might seems weird to you &amp; may raise a question that how can you change the behaviour of a class without modifying it?</li>
<li>But there are many answers to this in <a href="/posts/memory-layout-of-cpp-object/" >object-oriented design</a> like <a href="/posts/part-1-all-about-virtual-keyword-in-cpp-how-virtual-function-works-internally/" >dynamic polymorphism</a>, <a href="/posts/7-advanced-cpp-concepts-idiom-examples-you-should-know/#CRTP" >static polymorphism</a>, <a href="/posts/c-template-a-quick-uptodate-look/" >C++ template</a>, etc.</li>
</ul>
<h2 id="motivation-violating-the-open-closed-principle">
  Motivation: Violating the Open Closed Principle
  <a class="heading-link" href="#motivation-violating-the-open-closed-principle">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">COLOR</span> { RED, GREEN, BLUE };
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SIZE</span> { SMALL, MEDIUM, LARGE };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Product</span> {
</span></span><span style="display:flex;"><span>    string  m_name;
</span></span><span style="display:flex;"><span>    COLOR   m_color;
</span></span><span style="display:flex;"><span>    SIZE    m_size;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> Items <span style="color:#f92672">=</span> vector<span style="color:#f92672">&lt;</span>Product<span style="color:#f92672">*&gt;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define ALL(C)  begin(C), end(C)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">ProductFilter</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> Items <span style="color:#a6e22e">by_color</span>(Items items, <span style="color:#66d9ef">const</span> COLOR e_color) {
</span></span><span style="display:flex;"><span>        Items result;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>i : items)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i<span style="color:#f92672">-&gt;</span>m_color <span style="color:#f92672">==</span> e_color)
</span></span><span style="display:flex;"><span>                result.push_back(i);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> Items <span style="color:#a6e22e">by_size</span>(Items items, <span style="color:#66d9ef">const</span> SIZE e_size) {
</span></span><span style="display:flex;"><span>        Items result;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>i : items)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i<span style="color:#f92672">-&gt;</span>m_size <span style="color:#f92672">==</span> e_size)
</span></span><span style="display:flex;"><span>                result.push_back(i);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> Items <span style="color:#a6e22e">by_size_and_color</span>(Items items, <span style="color:#66d9ef">const</span> SIZE e_size, <span style="color:#66d9ef">const</span> COLOR e_color) {
</span></span><span style="display:flex;"><span>        Items result;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>i : items)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i<span style="color:#f92672">-&gt;</span>m_size <span style="color:#f92672">==</span> e_size <span style="color:#f92672">&amp;&amp;</span> i<span style="color:#f92672">-&gt;</span>m_color <span style="color:#f92672">==</span> e_color)
</span></span><span style="display:flex;"><span>                result.push_back(i);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> Items all{
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Product{<span style="color:#e6db74">&#34;Apple&#34;</span>, COLOR<span style="color:#f92672">::</span>GREEN, SIZE<span style="color:#f92672">::</span>SMALL},
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Product{<span style="color:#e6db74">&#34;Tree&#34;</span>, COLOR<span style="color:#f92672">::</span>GREEN, SIZE<span style="color:#f92672">::</span>LARGE},
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Product{<span style="color:#e6db74">&#34;House&#34;</span>, COLOR<span style="color:#f92672">::</span>BLUE, SIZE<span style="color:#f92672">::</span>LARGE},
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>p : ProductFilter<span style="color:#f92672">::</span>by_color(all, COLOR<span style="color:#f92672">::</span>GREEN))
</span></span><span style="display:flex;"><span>        cout <span style="color:#f92672">&lt;&lt;</span> p<span style="color:#f92672">-&gt;</span>m_name <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; is green</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>p : ProductFilter<span style="color:#f92672">::</span>by_size_and_color(all, SIZE<span style="color:#f92672">::</span>LARGE, COLOR<span style="color:#f92672">::</span>GREEN))
</span></span><span style="display:flex;"><span>        cout <span style="color:#f92672">&lt;&lt;</span> p<span style="color:#f92672">-&gt;</span>m_name <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; is green &amp; large</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> EXIT_SUCCESS;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">Apple is green
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">Tree is green
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">Tree is green &amp; large
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span></code></pre></div><ul>
<li>So we have a bunch of products &amp; we filtered it by some of its attributes. There is nothing wrong with the above code as far as the requirement is fixed(which will never be the case in software engineering).</li>
<li>But just imagine the situations: You already shipped the code to the client. Later on, requirement changes &amp; some new filters are required. In this case, you again need to modify the class &amp; add new filter methods.</li>
<li>This is a problematic approach because we have 2 attributes(i.e. color &amp; size) &amp; need to implement 3 function(i.e. color, size &amp; its combination), one more attributes &amp; need to implement 8 functions. You see where this is going.</li>
<li>You need to go again &amp; again in the existing implemented code &amp; have to modify it which may break other parts of code as well. This is not a scalable solution.</li>
<li>The open-closed principle states that your system should be open to extension but should be closed for modification. Unfortunately what we are doing here is modifying the existing code which is a violation of OCP.</li>
</ul>
<h2 id="solution-open-closed-principle-example-in-c">
  Solution: Open Closed Principle Example in C++
  <a class="heading-link" href="#solution-open-closed-principle-example-in-c">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>There is more than one way to achieve OCP. Here I am demonstrating the popular one i.e. interface design or abstraction level. So here is our scalable solution:</p>
<h3 id="adding-the-level-of-abstraction-for-extensibility">
  Adding the level of abstraction for extensibility
  <a class="heading-link" href="#adding-the-level-of-abstraction-for-extensibility">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Specification</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">virtual</span> <span style="color:#f92672">~</span>Specification() <span style="color:#f92672">=</span> <span style="color:#66d9ef">default</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">is_satisfied</span>(T <span style="color:#f92672">*</span>item) <span style="color:#66d9ef">const</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">ColorSpecification</span> <span style="color:#f92672">:</span> Specification<span style="color:#f92672">&lt;</span>Product<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    COLOR e_color;
</span></span><span style="display:flex;"><span>    ColorSpecification(COLOR e_color) <span style="color:#f92672">:</span> e_color(e_color) {}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">is_satisfied</span>(Product <span style="color:#f92672">*</span>item) <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> item<span style="color:#f92672">-&gt;</span>m_color <span style="color:#f92672">==</span> e_color; }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">SizeSpecification</span> <span style="color:#f92672">:</span> Specification<span style="color:#f92672">&lt;</span>Product<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    SIZE e_size;
</span></span><span style="display:flex;"><span>    SizeSpecification(SIZE e_size) <span style="color:#f92672">:</span> e_size(e_size) {}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">is_satisfied</span>(Product <span style="color:#f92672">*</span>item) <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> item<span style="color:#f92672">-&gt;</span>m_size <span style="color:#f92672">==</span> e_size; }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Filter</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">virtual</span> vector<span style="color:#f92672">&lt;</span>T <span style="color:#f92672">*&gt;</span> filter(vector<span style="color:#f92672">&lt;</span>T <span style="color:#f92672">*&gt;</span> items, <span style="color:#66d9ef">const</span> Specification<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>spec) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">BetterFilter</span> <span style="color:#f92672">:</span> Filter<span style="color:#f92672">&lt;</span>Product<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span>Product <span style="color:#f92672">*&gt;</span> filter(vector<span style="color:#f92672">&lt;</span>Product <span style="color:#f92672">*&gt;</span> items, <span style="color:#66d9ef">const</span> Specification<span style="color:#f92672">&lt;</span>Product<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>spec) {
</span></span><span style="display:flex;"><span>        vector<span style="color:#f92672">&lt;</span>Product <span style="color:#f92672">*&gt;</span> result;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>p : items)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (spec.is_satisfied(p))
</span></span><span style="display:flex;"><span>                result.push_back(p);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ------------------------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>BetterFilter bf;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>x : bf.filter(all, ColorSpecification(COLOR<span style="color:#f92672">::</span>GREEN)))
</span></span><span style="display:flex;"><span>    cout <span style="color:#f92672">&lt;&lt;</span> x<span style="color:#f92672">-&gt;</span>m_name <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; is green</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
</span></span></code></pre></div><ul>
<li>As you can see we do not have to modify <code>filter</code> method of <code>BetterFilter</code>. It can work with all kind of <code>specification</code> now.</li>
</ul>
<h3 id="for-two-or-more-combined-specifications">
  For two or more combined specifications
  <a class="heading-link" href="#for-two-or-more-combined-specifications">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">AndSpecification</span> <span style="color:#f92672">:</span> Specification<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> Specification<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>first;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> Specification<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>second;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    AndSpecification(<span style="color:#66d9ef">const</span> Specification<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>first, <span style="color:#66d9ef">const</span> Specification<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>second)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">:</span> first(first), second(second) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">is_satisfied</span>(T <span style="color:#f92672">*</span>item) <span style="color:#66d9ef">const</span> { 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> first.is_satisfied(item) <span style="color:#f92672">&amp;&amp;</span> second.is_satisfied(item); 
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">template</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>AndSpecification<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">&amp;&amp;</span>(<span style="color:#66d9ef">const</span> Specification<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>first, <span style="color:#66d9ef">const</span> Specification<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span>second) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> {first, second};
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// -----------------------------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">auto</span> green_things <span style="color:#f92672">=</span> ColorSpecification{COLOR<span style="color:#f92672">::</span>GREEN};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">auto</span> large_things <span style="color:#f92672">=</span> SizeSpecification{SIZE<span style="color:#f92672">::</span>LARGE};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BetterFilter bf;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>x : bf.filter(all, green_things <span style="color:#f92672">&amp;&amp;</span> large_things))
</span></span><span style="display:flex;"><span>    cout <span style="color:#f92672">&lt;&lt;</span> x<span style="color:#f92672">-&gt;</span>m_name <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; is green and large</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// warning: the following will compile but will NOT work
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// auto spec2 = SizeSpecification{SIZE::LARGE} &amp;&amp;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">//              ColorSpecification{COLOR::BLUE};
</span></span></span></code></pre></div><ul>
<li><code>SizeSpecification{SIZE::LARGE} &amp;&amp; ColorSpecification{COLOR::BLUE}</code> will not work. Experienced C++ eyes can easily recognize the reason. Though temporary object creation is a hint here. If you do so, you may get the error of <a href="/posts/part-1-all-about-virtual-keyword-in-cpp-how-virtual-function-works-internally/" >pure virtual function</a> as follows:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pure virtual method called
</span></span><span style="display:flex;"><span>terminate called without an active exception
</span></span><span style="display:flex;"><span>The terminal process terminated with exit code: <span style="color:#ae81ff">3</span>
</span></span></code></pre></div><ul>
<li>For more than two specifications, you can use a variadic template.</li>
</ul>
<h2 id="benefits-of-open-closed-principle">
  Benefits of Open Closed Principle
  <a class="heading-link" href="#benefits-of-open-closed-principle">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<h3 id="-extensibility">
  =&gt; Extensibility
  <a class="heading-link" href="#-extensibility">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>&ldquo;When a single change to a program results in a cascade of changes to dependent modules, that program exhibits the undesirable attributes that we have come to associate with &lsquo;bad&rsquo; design. The program becomes fragile, rigid, unpredictable and unreusable. The open-closed principle attacks this in a very straightforward way. It says that you should design modules that never change. When requirements change, you extend the behaviour of such modules by adding new code, not by changing old code that already works.&rdquo;<br>
— <a href="https://en.wikipedia.org/wiki/Robert_C._Martin"  class="external-link" target="_blank" rel="noopener">Robert Martin</a></p>
<h3 id="-maintainability">
  =&gt; Maintainability
  <a class="heading-link" href="#-maintainability">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li>The main benefit of this approach is that an interface introduces an additional level of abstraction which enables loose coupling. The implementations of an interface are independent of each other and don’t need to share any code.</li>
<li>Thus, you can easily cope-up with client&rsquo;s keep changing requirements. Very useful in agile methodologies.</li>
</ul>
<h3 id="-flexibility">
  =&gt; Flexibility
  <a class="heading-link" href="#-flexibility">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<ul>
<li>The open-closed principle also applies to plugin and middleware architecture. In that case, your base software entity is your application core functionality.</li>
<li>In the case of plugins, you have a base or core module that can be plugged with new features &amp; functionality through a common gateway interface. A good example of this is web browser extensions.</li>
<li>Binary compatibility will also be in-tact in subsequent releases.</li>
</ul>
<h2 id="yardstick-to-craft-open-closed-principle-friendly-software-in-c">
  Yardstick to Craft Open Closed Principle Friendly Software in C++
  <a class="heading-link" href="#yardstick-to-craft-open-closed-principle-friendly-software-in-c">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ul>
<li>In the SRP, you make a judgement about decomposition and where to draw encapsulation boundaries in your code. In the OCP, you make a judgement about what in your module you will make abstract and leave to your module’s consumers to make concrete, and what concrete functionality to provide yourself.</li>
<li>There are many design patterns that help us to extend code without changing it. For instance, the <a href="/posts/decorator-design-pattern-in-modern-cpp/" >Decorator pattern</a> helps us to follow Open Close principle. Also, the <a href="/posts/factory-design-pattern-in-modern-cpp/" >Factory Method</a>, <a href="/posts/strategy-design-pattern-in-modern-cpp/" >Strategy pattern</a> or the <a href="/posts/observer-design-pattern-in-modern-cpp/" >Observer pattern</a> might be used to design an application easy to change with minimum changes in the existing code.</li>
</ul>
<h2 id="conclusion">
  Conclusion
  <a class="heading-link" href="#conclusion">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Keep in mind that classes can never be completely closed. There will always be unforeseen changes which require a class to be modified. However, if changes can be foreseen, such as seen above i.e. <code>filters</code>, then you have a perfect opportunity to apply the OCP to be future-ready when those change requests come rolling in.</p>

      </div>


      <footer>
        


        
        
        
        
        

        
        
      </footer>
    </article>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script>
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2024
     Vishal Chovatiya 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
