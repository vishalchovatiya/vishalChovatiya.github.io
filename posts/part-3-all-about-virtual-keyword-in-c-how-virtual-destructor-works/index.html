<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works? | Vishal Chovatiya</title>
<meta name=keywords content="abstract-class-destructor-c,all-about-virtual-keyword-in-c,c-virtual-destructor-override,c-abstract-class-destructor,c-abstract-class-virtual-destructor,c-abstract-destructor,c-call-base-class-destructor,c-destructor-virtual,c-interface-virtual-destructor,c-override-virtual-destructor,c-protected-destructor,c-pure-virtual-destructor,c-virtual-destructor-default,c-virtual-destructor-example,delete-called-on-that-is-abstract-but-has-non-virtual-destructor,destructor-in-derived-class-in-c,destructor-virtual-c,how-does-virtual-destructor-works,how-virtual-destructor-works,pure-virtual-destructor,pure-virtual-destructor-c,pure-virtual-destructor-in-c,tricky-example-of-virtual-destructor,use-of-virtual-destructor,verifying-compiler-augmented-code-in-case-of-the-virtual-destructor,virtual-constructor-and-destructor-in-c,virtual-destructor,virtual-destructor-c,virtual-destructor-c-example,virtual-destructor-cpp,virtual-destructor-example,virtual-destructor-in-abstract-class-c,virtual-destructor-in-c-plus-plus,virtual-destructor-in-c,virtual-destructor-in-c-example,virtual-destructor-in-c-program,virtual-destructor-in-cpp,virtual-destructor-in-cpp-file,virtual-destructor-in-derived-class,why-do-we-need-a-virtual-destructor,why-need-virtual-destructor-c,why-we-need-a-virtual-destructor"><meta name=description content="Finally, we are in the 3rd & last part of this series. We have already discussed how virtual function & virtual class/inheritance works internally in previous parts. We left one topic i.e. &ldquo;How Does Virtual Destructor Works?&rdquo; which we will see now. As usual, before learning anything new I usually start with “Why Do We Need It in the First Place?”
Why Do We Need a Virtual Destructor? We will understand this with our earlier example(slightly twisted): class protocol_t { private: uint8_t *_type; // storage ."><meta name=author content="Vishal Chovatiya"><link rel=canonical href=http://localhost:1313/posts/part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works?"><meta property="og:description" content="Finally, we are in the 3rd & last part of this series. We have already discussed how virtual function & virtual class/inheritance works internally in previous parts. We left one topic i.e. &ldquo;How Does Virtual Destructor Works?&rdquo; which we will see now. As usual, before learning anything new I usually start with “Why Do We Need It in the First Place?”
Why Do We Need a Virtual Destructor? We will understand this with our earlier example(slightly twisted): class protocol_t { private: uint8_t *_type; // storage ."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works/"><meta property="og:image" content="http://localhost:1313/images/memory-layout-of-C-objects.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-09-12T00:00:00+00:00"><meta property="article:modified_time" content="2019-09-12T00:00:00+00:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/images/memory-layout-of-C-objects.png"><meta name=twitter:title content="Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works?"><meta name=twitter:description content="Finally, we are in the 3rd & last part of this series. We have already discussed how virtual function & virtual class/inheritance works internally in previous parts. We left one topic i.e. &ldquo;How Does Virtual Destructor Works?&rdquo; which we will see now. As usual, before learning anything new I usually start with “Why Do We Need It in the First Place?”
Why Do We Need a Virtual Destructor? We will understand this with our earlier example(slightly twisted): class protocol_t { private: uint8_t *_type; // storage ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works?","item":"http://localhost:1313/posts/part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works?","name":"Part 3: All About Virtual Keyword in C\u002b\u002b: How Does Virtual Destructor Works?","description":"Finally, we are in the 3rd \u0026amp; last part of this series. We have already discussed how virtual function \u0026amp; virtual class/inheritance works internally in previous parts. We left one topic i.e. \u0026ldquo;How Does Virtual Destructor Works?\u0026rdquo; which we will see now. As usual, before learning anything new I usually start with “Why Do We Need It in the First Place?”\nWhy Do We Need a Virtual Destructor? We will understand this with our earlier example(slightly twisted): class protocol_t { private: uint8_t *_type; // storage .","keywords":["abstract-class-destructor-c","all-about-virtual-keyword-in-c","c-virtual-destructor-override","c-abstract-class-destructor","c-abstract-class-virtual-destructor","c-abstract-destructor","c-call-base-class-destructor","c-destructor-virtual","c-interface-virtual-destructor","c-override-virtual-destructor","c-protected-destructor","c-pure-virtual-destructor","c-virtual-destructor-default","c-virtual-destructor-example","delete-called-on-that-is-abstract-but-has-non-virtual-destructor","destructor-in-derived-class-in-c","destructor-virtual-c","how-does-virtual-destructor-works","how-virtual-destructor-works","pure-virtual-destructor","pure-virtual-destructor-c","pure-virtual-destructor-in-c","tricky-example-of-virtual-destructor","use-of-virtual-destructor","verifying-compiler-augmented-code-in-case-of-the-virtual-destructor","virtual-constructor-and-destructor-in-c","virtual-destructor","virtual-destructor-c","virtual-destructor-c-example","virtual-destructor-cpp","virtual-destructor-example","virtual-destructor-in-abstract-class-c","virtual-destructor-in-c-plus-plus","virtual-destructor-in-c","virtual-destructor-in-c-example","virtual-destructor-in-c-program","virtual-destructor-in-cpp","virtual-destructor-in-cpp-file","virtual-destructor-in-derived-class","why-do-we-need-a-virtual-destructor","why-need-virtual-destructor-c","why-we-need-a-virtual-destructor"],"articleBody":"Finally, we are in the 3rd \u0026 last part of this series. We have already discussed how virtual function \u0026 virtual class/inheritance works internally in previous parts. We left one topic i.e. “How Does Virtual Destructor Works?” which we will see now. As usual, before learning anything new I usually start with “Why Do We Need It in the First Place?”\nWhy Do We Need a Virtual Destructor? We will understand this with our earlier example(slightly twisted): class protocol_t { private: uint8_t *_type; // storage ... public: protocol_t() { _type = new uint8_t; } ~protocol_t() { cout\u003c\u003c\"~protocol_t\"; delete _type; } virtual void authenticate(){}; virtual void connect(){}; // operations ... }; class wifi_t : public protocol_t { private: char *_pass; // storage ... public: wifi_t() { _pass = new char[15]; } ~wifi_t() { cout\u003c\u003c\"~wifi_t\"; delete _pass; } virtual void authenticate(){}; virtual void connect(){}; // operations ... }; class bluetooth_t : public protocol_t { private: char *_pass; // storage ... public: bluetooth_t() { _pass = new char[15]; } ~bluetooth_t(){ cout\u003c\u003c\"~bluetooth_t\"; delete _pass; } virtual void authenticate(){}; virtual void connect(){}; // operations ... }; void makeConnection(protocol_t *protocol) { protocol-\u003eauthenticate(); protocol-\u003econnect(); // Do some tx \u0026 rx delete protocol; } int main() { int prot_type = rand() % 2; makeConnection( (prot_type) ? new wifi_t : new bluetooth_t); return 0; } So, we have created wifi_t \u0026 bluetooth_t objects dynamically in main() and passed it to function makeConnection()` An objects of wifi_t, bluetooth_t \u0026 protocol_t also uses heap memory at construction \u0026 destruction time. Well, this code compiles \u0026 runs fine without any error. But when you run above code, at the time of delete protocol line it always calls the destructor of protocol_t which you can verify by ~protocol_t print on console. We are freeing only sub-object resources which is protocol_t in call of ~protocol_t() destructor. This means that there is a memory leak as we are not freeing heap memory resource of an object pointed by the pointer protocol_tin functionmakeConnection()` We even don’t know the type of object protocol_t pointer pointed to at the run time. Virtual destructors are there to solve this problem. What we have to do is that //... virtual ~protocol_t() { cout\u003c\u003c\"~protocol_t\"; delete _type; } //... Put keyword virtual in front of destructor ~protocol_t() Now delete protocol line will not directly call the destructor of protocol, rather it calls destructor indirectly i.e. using virtual table mechanism(in other words, dynamic dispatch). This way it calls the destructor of the object pointed i.e. either ~wifi_t() or ~bluetooth_t() by pointer protocol \u0026 then call the destructor of its base class i.e. ~protocol_t() Hence, virtual destructor uses to delete the object pointed by base class pointer/reference. How Does Virtual Destructor Works? The question is how our destructor of a derived class called. The answer is simple it calls the destructor indirectly i.e. using virtual table pointer(_vptr). Let’s understand it with the assumption that our pointer protocol points to an object of type wifi_t. protocol_t *protocol = new wifi_t; delete protocol; Here is the memory layout of the object wifi_t | | |--------------------------------| \u003c------ wifi_t class object memory layout | protocol_t::_type | |--------------------------------| | protocol_t::_vptr_protocol_t |----------| |--------------------------------| |----------|-------------------------| | wifi_t::_pass | | type_info wifi_t | |--------------------------------| |-------------------------| | | | wifi_t::authenticate | | | |-------------------------| | | | wifi_t::connect | | | |-------------------------| | | | wifi_t::~wifi_t | | | |-------------------------| Now, the statement delete protocol; will probably be transformed by a compiler into //... (*protocol-\u003evptr[3])(protocol); // Equivalent to `delete protocol;` //... Till here it was simple for us to understand how things are working. Because this is similar to a virtual function mechanism which we have seen in earlier articles. But the real magic comes when the destructor of a base class i.e. protocol_t will be called. Which is again done with augmented code by the compiler in derived class destructor \u0026 probably be: ~wifi_t() { cout\u003c\u003c\"~wifi_t\"; delete this-\u003e_pass; // Compiler augmented code ---------------------------------------------------- // Rewire virtual table this-\u003evptr = vtable_protocol_t; // vtable_protocol_t = address of static virtual table // Call to base class destructor protocol_t::~protocol_t(this); // ---------------------------------------------------------------------------- } The process of destructing an object takes more operations than those you write inside the body of the destructor. When the compiler generates the code for the destructor, it adds extra code both before and after the user-defined code. Here we have only taken after code for the sake of understanding. The same process will happen no matter how long tree up there is. Verifying Compiler Augmented Code in Case of the Virtual Destructor Although you can not see compiler augmented code(unless if you disassemble it), we can use one hack that will prove that compiler insert the call of base class destructor in a derived class destructor when we use a virtual destructor. For the same, consider the following code: class base { public: virtual ~base()=0; }; class derived : public base{ public: ~derived(){} }; int main(){ base *pbase = new derived; delete pbase; return 0; } When we use pure virtual destructor, the compiler will throw the following error at the time of linking: exit status 1 /tmp/main-06bc44.o: In function `derived::~derived()`: main.cpp:(.text._ZN7derivedD2Ev[_ZN7derivedD2Ev]+0x11): undefined reference to `base::~base()` clang: error: linker command failed with exit code 1 (use -v to see invocation) Hence, compiler tried to add the code for base class destructor call in the derived class destructor. But due to unavailability of base class destructor definition linker exited with an error. Tricky Example: Guess the Output Following example stolen from stackoverflow: struct base { virtual ~base() { f(); } virtual void f() { std::cout \u003c\u003c \"base\"; } }; struct derived : base { void f() { std::cout \u003c\u003c \"derived\"; } }; int main() { base * p = new derived; delete p; } I would recommend you to guess the output first \u0026 run it. If you get goosebump, try to interpret below line. Standard mandates that the runtime type of the object is that of the class being constructed/destructed at this time, even if the original object that is being constructed/destructed is of a derived type. Hence, it prints the output base. Summary Virtual destructor uses to delete the object pointed by base class pointer/reference Call to virtual destructor is done using dynamic dispatch Compiler augments the derived class destructor code by inserting a call to the base class destructor The runtime type of the object is that of the class being constructed/destructed at this time, even if the original object that is being constructed/destructed is of a derived type ","wordCount":"1079","inLanguage":"en","image":"http://localhost:1313/images/memory-layout-of-C-objects.png","datePublished":"2019-09-12T00:00:00Z","dateModified":"2019-09-12T00:00:00Z","author":{"@type":"Person","name":"Vishal Chovatiya"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works/"},"publisher":{"@type":"Organization","name":"Vishal Chovatiya","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Vishal Chovatiya (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Vishal Chovatiya</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/pages/vishal-chovatiya title="About Me"><span>About Me</span></a></li><li><a href=http://localhost:1313/pages/start-here title="Start Here"><span>Start Here</span></a></li><li><a href=http://localhost:1313/posts/ title=Latest><span>Latest</span></a></li><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works?</h1><div class=post-meta><span title='2019-09-12 00:00:00 +0000 UTC'>September 12, 2019</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1079 words&nbsp;·&nbsp;Vishal Chovatiya&nbsp;|&nbsp;<a href=https://github.com/vishalchovatiya/blog/vishalchovatiya/content/posts/part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=http://localhost:1313/images/memory-layout-of-C-objects.png alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#why-do-we-need-a-virtual-destructor>Why Do We Need a Virtual Destructor?</a></li><li><a href=#how-does-virtual-destructor-works>How Does Virtual Destructor Works?</a></li><li><a href=#verifying-compiler-augmented-code-in-case-of-the-virtual-destructor>Verifying Compiler Augmented Code in Case of the Virtual Destructor</a></li><li><a href=#tricky-example-guess-the-output>Tricky Example: Guess the Output</a></li><li><a href=#summary>Summary</a></li></ul></nav></div></details></div><div class=post-content><p>Finally, we are in the 3rd & last part of this series. We have already discussed how <a href=/posts/part-1-all-about-virtual-keyword-in-cpp-how-virtual-function-works-internally/>virtual function</a> & <a href=/posts/part-2-all-about-virtual-keyword-in-cpp-how-virtual-class-works-internally/>virtual class/inheritance</a> works internally in previous parts. We left one topic i.e. &ldquo;How Does Virtual Destructor Works?&rdquo; which we will see now. As usual, before learning anything new I usually start with “Why Do We Need It in the First Place?”</p><h2 id=why-do-we-need-a-virtual-destructor>Why Do We Need a Virtual Destructor?<a hidden class=anchor aria-hidden=true href=#why-do-we-need-a-virtual-destructor>#</a></h2><ul><li>We will understand this with our earlier example(slightly twisted):</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>protocol_t</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=kt>uint8_t</span> <span class=o>*</span><span class=n>_type</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// storage ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=n>protocol_t</span><span class=p>()</span> <span class=p>{</span> <span class=n>_type</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>uint8_t</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>~</span><span class=n>protocol_t</span><span class=p>()</span> <span class=p>{</span> <span class=n>cout</span><span class=o>&lt;&lt;</span><span class=s>&#34;~protocol_t&#34;</span><span class=p>;</span> <span class=k>delete</span> <span class=n>_type</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>authenticate</span><span class=p>(){};</span>
</span></span><span class=line><span class=cl>        <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>connect</span><span class=p>(){};</span>
</span></span><span class=line><span class=cl>        <span class=c1>// operations ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>wifi_t</span> <span class=o>:</span> <span class=k>public</span> <span class=n>protocol_t</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=o>*</span><span class=n>_pass</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// storage ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=n>wifi_t</span><span class=p>()</span> <span class=p>{</span> <span class=n>_pass</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>char</span><span class=p>[</span><span class=mi>15</span><span class=p>];</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>~</span><span class=n>wifi_t</span><span class=p>()</span> <span class=p>{</span> <span class=n>cout</span><span class=o>&lt;&lt;</span><span class=s>&#34;~wifi_t&#34;</span><span class=p>;</span> <span class=k>delete</span> <span class=n>_pass</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>authenticate</span><span class=p>(){};</span>
</span></span><span class=line><span class=cl>        <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>connect</span><span class=p>(){};</span>
</span></span><span class=line><span class=cl>        <span class=c1>// operations ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>bluetooth_t</span> <span class=o>:</span> <span class=k>public</span> <span class=n>protocol_t</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=o>*</span><span class=n>_pass</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// storage ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>        <span class=n>bluetooth_t</span><span class=p>()</span> <span class=p>{</span> <span class=n>_pass</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>char</span><span class=p>[</span><span class=mi>15</span><span class=p>];</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>~</span><span class=n>bluetooth_t</span><span class=p>(){</span> <span class=n>cout</span><span class=o>&lt;&lt;</span><span class=s>&#34;~bluetooth_t&#34;</span><span class=p>;</span> <span class=k>delete</span> <span class=n>_pass</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>authenticate</span><span class=p>(){};</span>
</span></span><span class=line><span class=cl>        <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>connect</span><span class=p>(){};</span>
</span></span><span class=line><span class=cl>        <span class=c1>// operations ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>makeConnection</span><span class=p>(</span><span class=n>protocol_t</span> <span class=o>*</span><span class=n>protocol</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>protocol</span><span class=o>-&gt;</span><span class=n>authenticate</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>protocol</span><span class=o>-&gt;</span><span class=n>connect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Do some tx &amp; rx
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>delete</span> <span class=n>protocol</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>prot_type</span> <span class=o>=</span> <span class=n>rand</span><span class=p>()</span> <span class=o>%</span> <span class=mi>2</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>    <span class=n>makeConnection</span><span class=p>(</span> <span class=p>(</span><span class=n>prot_type</span><span class=p>)</span> <span class=o>?</span> <span class=k>new</span> <span class=nl>wifi_t</span> <span class=p>:</span> <span class=k>new</span> <span class=n>bluetooth_t</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>So, we have created <code>wifi_t</code> & <code>bluetooth_t</code> objects dynamically in <code>main() and passed it to function </code>makeConnection()`</li><li>An objects of <code>wifi_t</code>, <code>bluetooth_t</code> & <code>protocol_t</code> also uses heap memory at construction & destruction time.</li><li>Well, this code compiles & runs fine without any error. But when you run above code, at the time of <code>delete protocol</code> line it always calls the destructor of <code>protocol_t</code> which you can verify by <code>~protocol_t</code> print on console.</li><li>We are freeing only sub-object resources which is <code>protocol_t</code> in call of <code>~protocol_t() destructor. This means that there is a memory leak as we are not freeing heap memory resource of an object pointed by the pointer </code>protocol_t<code>in function</code>makeConnection()`</li><li>We even don&rsquo;t know the type of object <code>protocol_t</code> pointer pointed to at the run time.</li><li>Virtual destructors are there to solve this problem. What we have to do is that</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>//...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>virtual</span> <span class=o>~</span><span class=n>protocol_t</span><span class=p>()</span> <span class=p>{</span> <span class=n>cout</span><span class=o>&lt;&lt;</span><span class=s>&#34;~protocol_t&#34;</span><span class=p>;</span> <span class=k>delete</span> <span class=n>_type</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>//...
</span></span></span></code></pre></div><ul><li>Put keyword <strong>virtual</strong> in front of destructor <code>~protocol_t()</code> Now <code>delete protocol</code> line will not directly call the destructor of <code>protocol</code>, rather it calls destructor indirectly i.e. using virtual table mechanism(in other words, dynamic dispatch).</li><li>This way it calls the destructor of the object pointed i.e. either <code>~wifi_t() or </code>~bluetooth_t() by pointer <code>protocol</code> & then call the destructor of its base class i.e. <code>~protocol_t()</code></li><li>Hence, <strong><em>virtual destructor uses to delete the object pointed by base class pointer/reference</em></strong>.</li></ul><h2 id=how-does-virtual-destructor-works>How Does Virtual Destructor Works?<a hidden class=anchor aria-hidden=true href=#how-does-virtual-destructor-works>#</a></h2><ul><li>The question is how our destructor of a derived class called. The answer is simple it calls the destructor indirectly i.e. using virtual table pointer(<code>_vptr</code>). Let&rsquo;s understand it with the assumption that our pointer <code>protocol</code> points to an object of type <code>wifi_t</code>.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>protocol_t</span> <span class=o>*</span><span class=n>protocol</span> <span class=o>=</span> <span class=k>new</span> <span class=n>wifi_t</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>delete</span> <span class=n>protocol</span><span class=p>;</span>
</span></span></code></pre></div><ul><li>Here is the memory layout of the object <code>wifi_t</code></li></ul><pre tabindex=0><code>|                                |          
|--------------------------------| &lt;------ wifi_t class object memory layout
|  protocol_t::_type             |          
|--------------------------------|          
|  protocol_t::_vptr_protocol_t  |----------|
|--------------------------------|          |----------|-------------------------|
|  wifi_t::_pass                 |                     |   type_info wifi_t      |
|--------------------------------|                     |-------------------------|
|                                |                     |   wifi_t::authenticate  |
|                                |                     |-------------------------|
|                                |                     |   wifi_t::connect       |
|                                |                     |-------------------------|
|                                |                     |   wifi_t::~wifi_t       |
|                                |                     |-------------------------|
</code></pre><ul><li>Now, the statement <code>delete protocol;</code> will probably be transformed by a compiler into</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>//...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>(</span><span class=o>*</span><span class=n>protocol</span><span class=o>-&gt;</span><span class=n>vptr</span><span class=p>[</span><span class=mi>3</span><span class=p>])(</span><span class=n>protocol</span><span class=p>);</span>  <span class=c1>// Equivalent to `delete protocol;`
</span></span></span><span class=line><span class=cl><span class=c1>//...
</span></span></span></code></pre></div><ul><li>Till here it was simple for us to understand how things are working. Because this is similar to a <a href=/posts/part-1-all-about-virtual-keyword-in-cpp-how-virtual-function-works-internally/>virtual function</a> mechanism which we have seen in earlier articles. But the real magic comes when the destructor of a base class i.e. <code>protocol_t</code> will be called.</li><li>Which is again done with augmented code by the compiler in derived class destructor & probably be:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=o>~</span><span class=n>wifi_t</span><span class=p>()</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=n>cout</span><span class=o>&lt;&lt;</span><span class=s>&#34;~wifi_t&#34;</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>    <span class=k>delete</span> <span class=k>this</span><span class=o>-&gt;</span><span class=n>_pass</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Compiler augmented code ----------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// Rewire virtual table
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=o>-&gt;</span><span class=n>vptr</span> <span class=o>=</span> <span class=n>vtable_protocol_t</span><span class=p>;</span> <span class=c1>// vtable_protocol_t = address of static virtual table
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// Call to base class destructor
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>protocol_t</span><span class=o>::~</span><span class=n>protocol_t</span><span class=p>(</span><span class=k>this</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>    <span class=c1>// ----------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><ul><li>The process of destructing an object takes more operations than those you write inside the body of the destructor. When the compiler generates the code for the destructor, it adds extra code both before and after the user-defined code. Here we have only taken after code for the sake of understanding.</li><li>The same process will happen no matter how long tree up there is.</li></ul><h2 id=verifying-compiler-augmented-code-in-case-of-the-virtual-destructor>Verifying Compiler Augmented Code in Case of the Virtual Destructor<a hidden class=anchor aria-hidden=true href=#verifying-compiler-augmented-code-in-case-of-the-virtual-destructor>#</a></h2><ul><li>Although you can not see compiler augmented code(unless if you disassemble it), we can use one hack that will prove that compiler insert the call of base class destructor in a derived class destructor when we use a virtual destructor.</li><li>For the same, consider the following code:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>base</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=o>~</span><span class=n>base</span><span class=p>()</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>derived</span> <span class=o>:</span> <span class=k>public</span> <span class=n>base</span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=o>~</span><span class=n>derived</span><span class=p>(){}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>  <span class=n>base</span> <span class=o>*</span><span class=n>pbase</span> <span class=o>=</span> <span class=k>new</span> <span class=n>derived</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>delete</span> <span class=n>pbase</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>When we use <strong><em>pure virtual destructor</em></strong>, the compiler will throw the following error at the time of linking:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>exit</span> <span class=n>status</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>main</span><span class=o>-</span><span class=mo>06</span><span class=n>bc44</span><span class=p>.</span><span class=nl>o</span><span class=p>:</span> <span class=n>In</span> <span class=n>function</span> <span class=err>`</span><span class=n>derived</span><span class=o>::~</span><span class=n>derived</span><span class=p>()</span><span class=err>`</span><span class=o>:</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=p>.</span><span class=nl>cpp</span><span class=p>:(.</span><span class=n>text</span><span class=p>.</span><span class=n>_ZN7derivedD2Ev</span><span class=p>[</span><span class=n>_ZN7derivedD2Ev</span><span class=p>]</span><span class=o>+</span><span class=mh>0x11</span><span class=p>)</span><span class=o>:</span> <span class=n>undefined</span> <span class=n>reference</span> <span class=n>to</span> <span class=err>`</span><span class=n>base</span><span class=o>::~</span><span class=n>base</span><span class=p>()</span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=nl>clang</span><span class=p>:</span> <span class=nl>error</span><span class=p>:</span> <span class=n>linker</span> <span class=n>command</span> <span class=n>failed</span> <span class=n>with</span> <span class=n>exit</span> <span class=n>code</span> <span class=mi>1</span> <span class=p>(</span><span class=n>use</span> <span class=o>-</span><span class=n>v</span> <span class=n>to</span> <span class=n>see</span> <span class=n>invocation</span><span class=p>)</span>
</span></span></code></pre></div><ul><li>Hence, compiler tried to add the code for base class destructor call in the derived class destructor. But due to unavailability of base class destructor definition linker exited with an error.</li></ul><h2 id=tricky-example-guess-the-output>Tricky Example: Guess the Output<a hidden class=anchor aria-hidden=true href=#tricky-example-guess-the-output>#</a></h2><ul><li>Following example stolen from <a href=https://stackoverflow.com/questions/7750280/how-does-virtual-destructor-work-in-c>stackoverflow</a>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>struct</span> <span class=nc>base</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>virtual</span> <span class=o>~</span><span class=n>base</span><span class=p>()</span> <span class=p>{</span> <span class=n>f</span><span class=p>();</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>f</span><span class=p>()</span> <span class=p>{</span> <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;base&#34;</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>derived</span> <span class=o>:</span> <span class=n>base</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=kt>void</span> <span class=nf>f</span><span class=p>()</span> <span class=p>{</span> <span class=n>std</span><span class=o>::</span><span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;derived&#34;</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=n>base</span> <span class=o>*</span> <span class=n>p</span> <span class=o>=</span> <span class=k>new</span> <span class=n>derived</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=k>delete</span> <span class=n>p</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>I would recommend you to guess the output first & run it. If you get goosebump, try to interpret below line.</li><li>Standard mandates that the runtime type of the object is that of the class being constructed/destructed at this time, even if the original object that is being constructed/destructed is of a derived type.</li><li>Hence, it prints the output <code>base</code>.</li></ul><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><ol><li>Virtual destructor uses to delete the object pointed by base class pointer/reference</li><li>Call to virtual destructor is done using dynamic dispatch</li><li>Compiler augments the derived class destructor code by inserting a call to the base class destructor</li><li>The runtime type of the object is that of the class being constructed/destructed at this time, even if the original object that is being constructed/destructed is of a derived type</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/abstract-class-destructor-c/>Abstract-Class-Destructor-C</a></li><li><a href=http://localhost:1313/tags/all-about-virtual-keyword-in-c/>All-About-Virtual-Keyword-in-C</a></li><li><a href=http://localhost:1313/tags/c-virtual-destructor-override/>C-Virtual-Destructor-Override</a></li><li><a href=http://localhost:1313/tags/c-abstract-class-destructor/>C-Abstract-Class-Destructor</a></li><li><a href=http://localhost:1313/tags/c-abstract-class-virtual-destructor/>C-Abstract-Class-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/c-abstract-destructor/>C-Abstract-Destructor</a></li><li><a href=http://localhost:1313/tags/c-call-base-class-destructor/>C-Call-Base-Class-Destructor</a></li><li><a href=http://localhost:1313/tags/c-destructor-virtual/>C-Destructor-Virtual</a></li><li><a href=http://localhost:1313/tags/c-interface-virtual-destructor/>C-Interface-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/c-override-virtual-destructor/>C-Override-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/c-protected-destructor/>C-Protected-Destructor</a></li><li><a href=http://localhost:1313/tags/c-pure-virtual-destructor/>C-Pure-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/c-virtual-destructor-default/>C-Virtual-Destructor-Default</a></li><li><a href=http://localhost:1313/tags/c-virtual-destructor-example/>C-Virtual-Destructor-Example</a></li><li><a href=http://localhost:1313/tags/delete-called-on-that-is-abstract-but-has-non-virtual-destructor/>Delete-Called-on-That-Is-Abstract-but-Has-Non-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/destructor-in-derived-class-in-c/>Destructor-in-Derived-Class-in-C</a></li><li><a href=http://localhost:1313/tags/destructor-virtual-c/>Destructor-Virtual-C</a></li><li><a href=http://localhost:1313/tags/how-does-virtual-destructor-works/>How-Does-Virtual-Destructor-Works</a></li><li><a href=http://localhost:1313/tags/how-virtual-destructor-works/>How-Virtual-Destructor-Works</a></li><li><a href=http://localhost:1313/tags/pure-virtual-destructor/>Pure-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/pure-virtual-destructor-c/>Pure-Virtual-Destructor-C</a></li><li><a href=http://localhost:1313/tags/pure-virtual-destructor-in-c/>Pure-Virtual-Destructor-in-C</a></li><li><a href=http://localhost:1313/tags/tricky-example-of-virtual-destructor/>Tricky-Example-of-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/use-of-virtual-destructor/>Use-of-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/verifying-compiler-augmented-code-in-case-of-the-virtual-destructor/>Verifying-Compiler-Augmented-Code-in-Case-of-the-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/virtual-constructor-and-destructor-in-c/>Virtual-Constructor-and-Destructor-in-C</a></li><li><a href=http://localhost:1313/tags/virtual-destructor/>Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-c/>Virtual-Destructor-C</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-c-example/>Virtual-Destructor-C-Example</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-cpp/>Virtual-Destructor-Cpp</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-example/>Virtual-Destructor-Example</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-in-abstract-class-c/>Virtual-Destructor-in-Abstract-Class-C</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-in-c-plus-plus/>Virtual-Destructor-in-C-Plus-Plus</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-in-c/>Virtual-Destructor-in-C</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-in-c-example/>Virtual-Destructor-in-C-Example</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-in-c-program/>Virtual-Destructor-in-C-Program</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-in-cpp/>Virtual-Destructor-in-Cpp</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-in-cpp-file/>Virtual-Destructor-in-Cpp-File</a></li><li><a href=http://localhost:1313/tags/virtual-destructor-in-derived-class/>Virtual-Destructor-in-Derived-Class</a></li><li><a href=http://localhost:1313/tags/why-do-we-need-a-virtual-destructor/>Why-Do-We-Need-a-Virtual-Destructor</a></li><li><a href=http://localhost:1313/tags/why-need-virtual-destructor-c/>Why-Need-Virtual-Destructor-C</a></li><li><a href=http://localhost:1313/tags/why-we-need-a-virtual-destructor/>Why-We-Need-a-Virtual-Destructor</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/complications-of-using-the-virtual-base-class/><span class=title>« Prev</span><br><span>Complications of Using the Virtual Base Class</span>
</a><a class=next href=http://localhost:1313/posts/when-to-use-const-vs-constexpr-in-cpp/><span class=title>Next »</span><br><span>When to Use const vs constexpr in C++</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works? on x" href="https://x.com/intent/tweet/?text=Part%203%3a%20All%20About%20Virtual%20Keyword%20in%20C%2b%2b%3a%20How%20Does%20Virtual%20Destructor%20Works%3f&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fpart-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works%2f&amp;hashtags=abstract-class-destructor-c%2call-about-virtual-keyword-in-c%2cc-virtual-destructor-override%2cc-abstract-class-destructor%2cc-abstract-class-virtual-destructor%2cc-abstract-destructor%2cc-call-base-class-destructor%2cc-destructor-virtual%2cc-interface-virtual-destructor%2cc-override-virtual-destructor%2cc-protected-destructor%2cc-pure-virtual-destructor%2cc-virtual-destructor-default%2cc-virtual-destructor-example%2cdelete-called-on-that-is-abstract-but-has-non-virtual-destructor%2cdestructor-in-derived-class-in-c%2cdestructor-virtual-c%2chow-does-virtual-destructor-works%2chow-virtual-destructor-works%2cpure-virtual-destructor%2cpure-virtual-destructor-c%2cpure-virtual-destructor-in-c%2ctricky-example-of-virtual-destructor%2cuse-of-virtual-destructor%2cverifying-compiler-augmented-code-in-case-of-the-virtual-destructor%2cvirtual-constructor-and-destructor-in-c%2cvirtual-destructor%2cvirtual-destructor-c%2cvirtual-destructor-c-example%2cvirtual-destructor-cpp%2cvirtual-destructor-example%2cvirtual-destructor-in-abstract-class-c%2cvirtual-destructor-in-c-plus-plus%2cvirtual-destructor-in-c%2cvirtual-destructor-in-c-example%2cvirtual-destructor-in-c-program%2cvirtual-destructor-in-cpp%2cvirtual-destructor-in-cpp-file%2cvirtual-destructor-in-derived-class%2cwhy-do-we-need-a-virtual-destructor%2cwhy-need-virtual-destructor-c%2cwhy-we-need-a-virtual-destructor"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works? on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fpart-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works%2f&amp;title=Part%203%3a%20All%20About%20Virtual%20Keyword%20in%20C%2b%2b%3a%20How%20Does%20Virtual%20Destructor%20Works%3f&amp;summary=Part%203%3a%20All%20About%20Virtual%20Keyword%20in%20C%2b%2b%3a%20How%20Does%20Virtual%20Destructor%20Works%3f&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fpart-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works? on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fpart-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works%2f&title=Part%203%3a%20All%20About%20Virtual%20Keyword%20in%20C%2b%2b%3a%20How%20Does%20Virtual%20Destructor%20Works%3f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works? on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fpart-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works? on whatsapp" href="https://api.whatsapp.com/send?text=Part%203%3a%20All%20About%20Virtual%20Keyword%20in%20C%2b%2b%3a%20How%20Does%20Virtual%20Destructor%20Works%3f%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fpart-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works? on telegram" href="https://telegram.me/share/url?text=Part%203%3a%20All%20About%20Virtual%20Keyword%20in%20C%2b%2b%3a%20How%20Does%20Virtual%20Destructor%20Works%3f&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fpart-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Part 3: All About Virtual Keyword in C++: How Does Virtual Destructor Works? on ycombinator" href="https://news.ycombinator.com/submitlink?t=Part%203%3a%20All%20About%20Virtual%20Keyword%20in%20C%2b%2b%3a%20How%20Does%20Virtual%20Destructor%20Works%3f&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fpart-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Vishal Chovatiya</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>