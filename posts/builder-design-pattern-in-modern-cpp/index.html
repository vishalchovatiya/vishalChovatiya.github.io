<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  Builder Design Pattern in Modern C&#43;&#43; · Vishal Chovatiya
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Vishal Chovatiya">
<meta name="description" content="In software engineering, Creational Design Patterns deal with object creation mechanisms, trying to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. Builder Design Pattern in C&#43;&#43; solves this specific problem by separating the construction of a complex object from its representation.
By the way, If you haven’t check out my other articles on Creational Design Patterns, then here is the list:">
<meta name="keywords" content="blog,developer,personal">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Builder Design Pattern in Modern C&#43;&#43;">
  <meta name="twitter:description" content="In software engineering, Creational Design Patterns deal with object creation mechanisms, trying to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. Builder Design Pattern in C&#43;&#43; solves this specific problem by separating the construction of a complex object from its representation.
By the way, If you haven’t check out my other articles on Creational Design Patterns, then here is the list:">

<meta property="og:url" content="http://localhost:1313/posts/builder-design-pattern-in-modern-cpp/">
  <meta property="og:site_name" content="Vishal Chovatiya">
  <meta property="og:title" content="Builder Design Pattern in Modern C&#43;&#43;">
  <meta property="og:description" content="In software engineering, Creational Design Patterns deal with object creation mechanisms, trying to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. Builder Design Pattern in C&#43;&#43; solves this specific problem by separating the construction of a complex object from its representation.
By the way, If you haven’t check out my other articles on Creational Design Patterns, then here is the list:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-04-06T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-04-06T00:00:00+00:00">




<link rel="canonical" href="http://localhost:1313/posts/builder-design-pattern-in-modern-cpp/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">








 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>




<body class="preload-transitions colorscheme-light">
  

  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      Vishal Chovatiya
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Latest</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/pages/start-here">Start Here</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/cpp/">C/C&#43;&#43;</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/linux-system-programming/">Linux System Programming</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/misc/">Misc</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/builder-design-pattern-in-modern-cpp/">
              Builder Design Pattern in Modern C&#43;&#43;
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2020-04-06T00:00:00Z">
                April 6, 2020
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              8-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/cpp/">Cpp</a>
      <span class="separator">•</span>
    <a href="/categories/design-patterns/">Design-Patterns</a>
      <span class="separator">•</span>
    <a href="/categories/software-engineering/">Software-Engineering</a></div>

          
        </div>
      </header>

      <div class="post-content">
        
          <img src="/images/Builder-Design-Pattern-in-Modern-C-vishal-chovatiya.webp" alt="Featured image"/>
        
        <p>In software engineering, Creational Design Patterns deal with object creation mechanisms, trying to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. Builder Design Pattern in C++ solves this specific problem by <strong><em>separating the construction of a complex object from its representation</em></strong>.</p>
<p>By the way, If you haven’t check out my other articles on Creational Design Patterns, then here is the list:</p>
<ol>
<li><a href="/posts//factory-design-pattern-in-modern-cpp/" >Factory</a></li>
<li><a href="/posts//builder-design-pattern-in-modern-cpp/" >Builder</a></li>
<li><a href="/posts//prototype-design-pattern-in-modern-cpp/" >Prototype</a></li>
<li><a href="/posts//singleton-design-pattern-in-modern-cpp/" >Singleton</a></li>
</ol>
<p>The code snippets you see throughout this series of articles are simplified not sophisticated. So you often see me not using keywords like <code>override</code>, <code>final</code>, <code>public</code>(while inheritance) just to make code compact &amp; consumable(most of the time) in single standard screen size. I also prefer <code>struct</code> instead of <code>class</code> just to save line by not writing &ldquo;<code>public:</code>&rdquo; sometimes and also miss <a href="/posts//part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works/" >virtual destructor</a>, constructor, <a href="/posts//all-about-copy-constructor-in-cpp-with-example/" >copy constructor</a>, prefix <code>std::</code>, deleting dynamic memory, intentionally. I also consider myself a pragmatic person who wants to convey an idea in the simplest way possible rather than the standard way or using Jargons.</p>
<p><strong><em>Note:</em></strong></p>
<ul>
<li>If you stumbled here directly, then I would suggest you go through <a href="/posts//what-is-design-pattern/" >What is design pattern?</a> first, even if it is trivial. I believe it will encourage you to explore more on this topic.</li>
<li>All of this code you encounter in this series of articles are compiled using C++20(though I have used <a href="/posts//21-new-features-of-modern-cpp-to-use-in-your-project/" >Modern C++</a> features up to C++17 in most cases). So if you don&rsquo;t have access to the latest compiler you can use <a href="https://wandbox.org/"  class="external-link" target="_blank" rel="noopener">https://wandbox.org/</a> which has preinstalled boost library as well.</li>
</ul>
<h2 id="intent">
  Intent
  <a class="heading-link" href="#intent">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<blockquote>
<p><strong><em>To create/instantiate complex &amp; complicated object piecewise &amp; succinctly by providing an API in a separate entity.</em></strong></p>
</blockquote>
<ul>
<li>Builder Design Pattern is used when we want to construct a complex object. However, we do not want to have a complex constructor member or one that would need many arguments.</li>
<li>The Builder Design Pattern constructs a complex object step by step &amp; the final step will return the object. The process of constructing an object should be generic so that it can be used to create different representations of the same object with the help of a variety of methods.</li>
</ul>
<h2 id="life-without-builders">
  Life Without Builders
  <a class="heading-link" href="#life-without-builders">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ul>
<li>Suppose you have to create the HTML generator using C++ then very naïve way to do it is :</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// &lt;p&gt;hello&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">auto</span> text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hello&#34;</span>;
</span></span><span style="display:flex;"><span>string output;
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;&lt;p&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">+=</span> text;
</span></span><span style="display:flex;"><span>output <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;&lt;/p&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>printf(<span style="color:#e6db74">&#34;&lt;p&gt;%s&lt;/p&gt;&#34;</span>, text);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// &lt;ul&gt;&lt;li&gt;hello&lt;/li&gt;&lt;li&gt;world&lt;/li&gt;&lt;/ul&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>string words[] <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;hello&#34;</span>, <span style="color:#e6db74">&#34;world&#34;</span>};
</span></span><span style="display:flex;"><span>ostringstream oss;
</span></span><span style="display:flex;"><span>oss <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;&lt;ul&gt;&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> w : words)
</span></span><span style="display:flex;"><span>    oss <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;  &lt;li&gt;&#34;</span> <span style="color:#f92672">&lt;&lt;</span> w <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;&lt;/li&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>oss <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;&lt;/ul&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>printf(oss.str().c_str());
</span></span></code></pre></div><ul>
<li>A sophisticated dev will create a class with a bunch of constructor argument &amp; method to add a child node. This is a good approach though but it may complicate the object representation.</li>
<li>In general, some objects are simple &amp; can be created in a single constructor call while other objects require a lot of ceremonies to create.</li>
<li>Having an object with 10 constructor arguments is not productive. Instead, we should opt for piecewise construction.</li>
<li>Builder provides an API for constructing an object step-by-step without revealing actual object representation.</li>
</ul>
<h2 id="builder-design-pattern-example-in-modern-c">
  Builder Design Pattern Example in Modern C++
  <a class="heading-link" href="#builder-design-pattern-example-in-modern-c">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HtmlBuilder</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HtmlElement</span> {
</span></span><span style="display:flex;"><span>    string                      m_name;
</span></span><span style="display:flex;"><span>    string                      m_text;
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span>HtmlElement<span style="color:#f92672">&gt;</span>         m_childs;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constexpr</span> <span style="color:#66d9ef">static</span> size_t     m_indent_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    HtmlElement() <span style="color:#f92672">=</span> <span style="color:#66d9ef">default</span>;
</span></span><span style="display:flex;"><span>    HtmlElement(<span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span>name, <span style="color:#66d9ef">const</span> string <span style="color:#f92672">&amp;</span>text) <span style="color:#f92672">:</span> m_name(name), m_text(text) {}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">friend</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HtmlBuilder</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    string str(<span style="color:#66d9ef">int32_t</span> indent <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        ostringstream oss;
</span></span><span style="display:flex;"><span>        oss <span style="color:#f92672">&lt;&lt;</span> string(m_indent_size <span style="color:#f92672">*</span> indent, <span style="color:#e6db74">&#39; &#39;</span>) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;&lt;&#34;</span> <span style="color:#f92672">&lt;&lt;</span> m_name <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;&gt;&#34;</span> <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (m_text.size()) oss <span style="color:#f92672">&lt;&lt;</span> string(m_indent_size <span style="color:#f92672">*</span> (indent <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>), <span style="color:#e6db74">&#39; &#39;</span>) <span style="color:#f92672">&lt;&lt;</span> m_text <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">auto</span> <span style="color:#f92672">&amp;</span>element : m_childs)
</span></span><span style="display:flex;"><span>            oss <span style="color:#f92672">&lt;&lt;</span> element.str(indent <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        oss <span style="color:#f92672">&lt;&lt;</span> string(m_indent_size <span style="color:#f92672">*</span> indent, <span style="color:#e6db74">&#39; &#39;</span>) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;&lt;/&#34;</span> <span style="color:#f92672">&lt;&lt;</span> m_name <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;&gt;&#34;</span> <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> oss.str();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> unique_ptr<span style="color:#f92672">&lt;</span>HtmlBuilder<span style="color:#f92672">&gt;</span> build(string root_name) { <span style="color:#66d9ef">return</span> make_unique<span style="color:#f92672">&lt;</span>HtmlBuilder<span style="color:#f92672">&gt;</span>(root_name); }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HtmlBuilder</span> {
</span></span><span style="display:flex;"><span>    HtmlElement     m_root;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    HtmlBuilder(string root_name) { m_root.m_name <span style="color:#f92672">=</span> root_name; }
</span></span><span style="display:flex;"><span>    HtmlBuilder <span style="color:#f92672">*</span><span style="color:#a6e22e">add_child</span>(string child_name, string child_text) {
</span></span><span style="display:flex;"><span>        m_root.m_childs.emplace_back(HtmlElement{child_name, child_text});
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    string <span style="color:#a6e22e">str</span>() { <span style="color:#66d9ef">return</span> m_root.str(); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">operator</span> <span style="color:#a6e22e">HtmlElement</span>() { <span style="color:#66d9ef">return</span> m_root; }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> builder <span style="color:#f92672">=</span> HtmlElement<span style="color:#f92672">::</span>build(<span style="color:#e6db74">&#34;ul&#34;</span>);
</span></span><span style="display:flex;"><span>    builder<span style="color:#f92672">-&gt;</span>add_child(<span style="color:#e6db74">&#34;li&#34;</span>, <span style="color:#e6db74">&#34;hello&#34;</span>)<span style="color:#f92672">-&gt;</span>add_child(<span style="color:#e6db74">&#34;li&#34;</span>, <span style="color:#e6db74">&#34;world&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cout <span style="color:#f92672">&lt;&lt;</span> builder<span style="color:#f92672">-&gt;</span>str() <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> EXIT_SUCCESS;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;ul&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    &lt;li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        hello
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    &lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    &lt;li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        world
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    &lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;/ul&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span></code></pre></div><ul>
<li>We are forcing users here to use builder by making data members of <code>HtmlElements</code> private.</li>
<li>As you can see, we have declared the <code>HtmlBuilder</code> &amp; <code>HtmlElement</code> in the same file &amp; to do so, we need forward declaration i.e. <code>class HtmlBuilder;</code> as it is an <a href="https://docs.microsoft.com/en-us/cpp/c-language/incomplete-types"  class="external-link" target="_blank" rel="noopener">incomplete type</a>. And we can not create the object of incomplete type before compiler parses its actual declaration. The reason is simple, the compiler needs the size of an object to allocate memory for it. Hence pointer is only way around so we have taken <a href="/posts/understanding-unique-ptr-with-example-in-cpp11/" >unique_ptr</a><!-- raw HTML omitted -->.</li>
</ul>
<h2 id="sophisticated-fluent-builder-design-pattern-example">
  Sophisticated &amp; Fluent Builder Design Pattern Example
  <a class="heading-link" href="#sophisticated-fluent-builder-design-pattern-example">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ul>
<li>Following is the more sophisticated example of the Builder Design Pattern in C++ organized in four different files(i.e. <code>Person.h</code>, <code>Person.cpp</code>, <code>PersonBuilder.h</code> <code>PersonBuilder.cpp</code>).</li>
</ul>
<p><strong><code>Person.h</code></strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#pragma once
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PersonBuilder</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>string m_name, m_street_address, m_post_code, m_city;  <span style="color:#75715e">// Personal Detail
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    std<span style="color:#f92672">::</span>string m_company_name, m_position, m_annual_income;    <span style="color:#75715e">// Employment Detail
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    Person(std<span style="color:#f92672">::</span>string name) <span style="color:#f92672">:</span> m_name(name) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">friend</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PersonBuilder</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">friend</span> ostream<span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">&lt;&lt;</span>(ostream<span style="color:#f92672">&amp;</span>  os, <span style="color:#66d9ef">const</span> Person<span style="color:#f92672">&amp;</span> obj);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> PersonBuilder <span style="color:#a6e22e">create</span>(std<span style="color:#f92672">::</span>string name);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p><strong><code>Person.cpp</code></strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;Person.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;PersonBuilder.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>PersonBuilder Person<span style="color:#f92672">::</span>create(string name) { <span style="color:#66d9ef">return</span> PersonBuilder{name}; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ostream<span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">operator</span><span style="color:#f92672">&lt;&lt;</span>(ostream<span style="color:#f92672">&amp;</span> os, <span style="color:#66d9ef">const</span> Person<span style="color:#f92672">&amp;</span> obj)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> os <span style="color:#f92672">&lt;&lt;</span> obj.m_name
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;lives : &#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;at &#34;</span> <span style="color:#f92672">&lt;&lt;</span> obj.m_street_address
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; with postcode &#34;</span> <span style="color:#f92672">&lt;&lt;</span> obj.m_post_code
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; in &#34;</span> <span style="color:#f92672">&lt;&lt;</span> obj.m_city
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;works : &#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;with &#34;</span> <span style="color:#f92672">&lt;&lt;</span> obj.m_company_name
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; as a &#34;</span> <span style="color:#f92672">&lt;&lt;</span> obj.m_position
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; earning &#34;</span> <span style="color:#f92672">&lt;&lt;</span> obj.m_annual_income;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>As you can see from the above example <code>Person</code> may have many details like Personal &amp; Professional. And so does the count of data members.</li>
<li>In our case, there are 7 data members. Having a single class for all the actions needed to create a Person through constructor might make our class bloated &amp; lose its original purpose. Moreover, the library user needs to take care of all those constructor parameters sequence.</li>
</ul>
<p><strong><code>PersonBuilder.h</code></strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#pragma once
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;Person.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PersonBuilder</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    Person person;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    PersonBuilder(string name) <span style="color:#f92672">:</span> person(name) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">operator</span> <span style="color:#a6e22e">Person</span>() <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> move(person); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    PersonBuilder<span style="color:#f92672">&amp;</span>  lives();
</span></span><span style="display:flex;"><span>    PersonBuilder<span style="color:#f92672">&amp;</span>  at(std<span style="color:#f92672">::</span>string street_address);
</span></span><span style="display:flex;"><span>    PersonBuilder<span style="color:#f92672">&amp;</span>  with_postcode(std<span style="color:#f92672">::</span>string post_code);
</span></span><span style="display:flex;"><span>    PersonBuilder<span style="color:#f92672">&amp;</span>  in(std<span style="color:#f92672">::</span>string city);
</span></span><span style="display:flex;"><span>    PersonBuilder<span style="color:#f92672">&amp;</span>  works();
</span></span><span style="display:flex;"><span>    PersonBuilder<span style="color:#f92672">&amp;</span>  with(string company_name);
</span></span><span style="display:flex;"><span>    PersonBuilder<span style="color:#f92672">&amp;</span>  as_a(string position);
</span></span><span style="display:flex;"><span>    PersonBuilder<span style="color:#f92672">&amp;</span>  earning(string annual_income);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p><strong><code>PersonBuilder.cpp</code></strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;PersonBuilder.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>PersonBuilder<span style="color:#f92672">&amp;</span>  PersonBuilder<span style="color:#f92672">::</span>lives() { <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PersonBuilder<span style="color:#f92672">&amp;</span>  PersonBuilder<span style="color:#f92672">::</span>works() { <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PersonBuilder<span style="color:#f92672">&amp;</span>  PersonBuilder<span style="color:#f92672">::</span>with(string company_name) {
</span></span><span style="display:flex;"><span>    person.m_company_name <span style="color:#f92672">=</span> company_name; 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PersonBuilder<span style="color:#f92672">&amp;</span>  PersonBuilder<span style="color:#f92672">::</span>as_a(string position) {
</span></span><span style="display:flex;"><span>    person.m_position <span style="color:#f92672">=</span> position; 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PersonBuilder<span style="color:#f92672">&amp;</span>  PersonBuilder<span style="color:#f92672">::</span>earning(string annual_income) {
</span></span><span style="display:flex;"><span>    person.m_annual_income <span style="color:#f92672">=</span> annual_income; 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PersonBuilder<span style="color:#f92672">&amp;</span>  PersonBuilder<span style="color:#f92672">::</span>at(std<span style="color:#f92672">::</span>string street_address) {
</span></span><span style="display:flex;"><span>    person.m_street_address <span style="color:#f92672">=</span> street_address; 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PersonBuilder<span style="color:#f92672">&amp;</span>  PersonBuilder<span style="color:#f92672">::</span>with_postcode(std<span style="color:#f92672">::</span>string post_code) {
</span></span><span style="display:flex;"><span>    person.m_post_code <span style="color:#f92672">=</span> post_code; 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PersonBuilder<span style="color:#f92672">&amp;</span>  PersonBuilder<span style="color:#f92672">::</span>in(std<span style="color:#f92672">::</span>string city) {
</span></span><span style="display:flex;"><span>    person.m_city <span style="color:#f92672">=</span> city; 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Rather stuffing all those construction related APIs into <code>Person</code>, we can delegate that task to separate entity i.e. <code>PersonBuilder</code>.</li>
</ul>
<p><strong><code>Main.cpp</code></strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;Person.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;PersonBuilder.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    Person p <span style="color:#f92672">=</span> Person<span style="color:#f92672">::</span>create(<span style="color:#e6db74">&#34;John&#34;</span>)
</span></span><span style="display:flex;"><span>                                .lives()
</span></span><span style="display:flex;"><span>                                    .at(<span style="color:#e6db74">&#34;123 London Road&#34;</span>)
</span></span><span style="display:flex;"><span>                                    .with_postcode(<span style="color:#e6db74">&#34;SW1 1GB&#34;</span>)
</span></span><span style="display:flex;"><span>                                    .in(<span style="color:#e6db74">&#34;London&#34;</span>)
</span></span><span style="display:flex;"><span>                                .works()
</span></span><span style="display:flex;"><span>                                    .with(<span style="color:#e6db74">&#34;PragmaSoft&#34;</span>)
</span></span><span style="display:flex;"><span>                                    .as_a(<span style="color:#e6db74">&#34;Consultant&#34;</span>)
</span></span><span style="display:flex;"><span>                                    .earning(<span style="color:#e6db74">&#34;10e6&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cout <span style="color:#f92672">&lt;&lt;</span> p <span style="color:#f92672">&lt;&lt;</span> endl;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> EXIT_SUCCESS;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Isn&rsquo;t the above construction looks more intuitive, natural &amp; plain English?</li>
<li>If you are concerned about blank methods like <code>lives()</code> &amp; <code>works()</code>, then do not worry, it will be eliminated in optimization.</li>
<li>You can also observe that we are forcing user&rsquo;s to use builder rather than constructor by making the constructor private &amp; exposing only <code>create(std::string name)</code> API.</li>
<li>Do not over complicate things by designing an interface or abstract classes unless you need it. I have seen this in many Builder Design Pattern Examples on Web.</li>
</ul>
<h2 id="benefits-of-builder-design-pattern">
  Benefits of Builder Design Pattern
  <a class="heading-link" href="#benefits-of-builder-design-pattern">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ul>
<li>The number of lines of code increases at least to double in builder pattern. But the effort pays off in terms of design flexibility, fewer or no parameters to the constructor and much more readable code.</li>
<li>Builder Design Pattern also helps in minimizing the number of parameters in constructor &amp; thus there is no need to pass in <a href="/posts/what-exactly-nullptr-is-in-cpp/" >null</a> for optional parameters to the constructor.</li>
<li>Immutable objects can be built without much complex logic in the object building process.</li>
<li>Segregating construction from <a href="/posts/memory-layout-of-cpp-object/" >object representation</a> makes the object representation slice &amp; precise. Having a builder entity separate provides the flexibility of creating &amp; instantiating different objects representations.</li>
</ul>
<h2 id="summary-by-faqs">
  Summary by FAQs
  <a class="heading-link" href="#summary-by-faqs">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p><strong>When should the Builder Design Pattern be used?</strong></p>
<p>Whenever creation of new object requires setting many parameters and some of them (or all of them) are optional.</p>
<p><strong>Why do we need a Builder class when implementing a Builder Design Pattern?</strong></p>
<p>It isn&rsquo;t necessary but there are some benefits in doing so:</p>
<ul>
<li>The concern of building object should be in the separate entity as per <a href="/posts/single-responsibility-principle-in-cpp-solid-as-a-rock/" >SRP</a>.</li>
<li>The original object would not be bloated.</li>
<li>Easy &amp; maintainable code.</li>
<li>Testing &amp; understanding a constructor with many input arguments gets exponentially more complicated.</li>
</ul>
<p><strong>Greatest Advantage of Builder Design Pattern!</strong></p>
<p>More expressive code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>MyClass o <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> MyClass(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5.5</span>, <span style="color:#e6db74">&#39;A&#39;</span>, var, <span style="color:#ae81ff">1000</span>, obj9, <span style="color:#e6db74">&#34;hello&#34;</span>);
</span></span></code></pre></div><ul>
<li>Instead</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>MyClass o <span style="color:#f92672">=</span> MyClass.builder().a(<span style="color:#ae81ff">5</span>).b(<span style="color:#ae81ff">5.5</span>).c(<span style="color:#e6db74">&#39;A&#39;</span>).d(var).e(<span style="color:#ae81ff">1000</span>).f(obj9).g(<span style="color:#e6db74">&#34;hello&#34;</span>);
</span></span></code></pre></div><ul>
<li>You can see which data member is being assigned by what &amp; even change the order of assignment.</li>
</ul>
<p><strong>What&rsquo;s the difference between Abstract Factory and Builder Design Pattern?</strong></p>
<ul>
<li>Factory produces the objects in wholesale that could be any object from inheritance hierarchy(like Point, Point2D, Point3D). While Builder deals with instantiation of an object that is limited to a single object(Although this statement is still debatable).</li>
<li>You see Factory is all about wholesale object creation while the builder is piecewise object creation. In both the patterns, you can separate out the mechanism related to object creation in other classes.</li>
</ul>

      </div>


      <footer>
        


        
        
        
        
        

        
        
      </footer>
    </article>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script>
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2024
     Vishal Chovatiya 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
