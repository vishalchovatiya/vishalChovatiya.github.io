<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Decorator Design Pattern in Modern C++ | Vishal Chovatiya</title>
<meta name=keywords content="benefits-of-decorator-design-pattern,c-decorator-examples,c-decorator-pattern-c11,c-design-patterns,decorator-design-pattern-c,decorator-design-pattern-c-code,decorator-design-pattern-examples-in-c,decorator-design-pattern-in-c,decorator-design-pattern-in-c-example,decorator-design-pattern-in-modern-c,decorator-pattern-c,decorator-pattern-c-example,difference-between-adapter-decorator-design-pattern,difference-between-proxy-decorator-design-pattern,dynamic-decorator,functional-decorator,limitation-of-dynamic-decorator,static-decorator,what-are-the-drawbacks-of-using-the-decorator-design-pattern,when-to-use-the-decorator-design-pattern"><meta name=description content="In software engineering, Structural Design Patterns deal with the relationship between object & classes i.e. how object & classes interact or build a relationship in a manner suitable to the situation. The Structural Design Patterns simplify the structure by identifying relationships. In this article of the Structural Design Patterns, we&rsquo;re going to take a look at the not so complex yet subtle design pattern that is Decorator Design Pattern in Modern C++ due to its extensibility & testability."><meta name=author content="Vishal Chovatiya"><link rel=canonical href=http://localhost:1313/posts/decorator-design-pattern-in-modern-cpp/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/decorator-design-pattern-in-modern-cpp/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Decorator Design Pattern in Modern C++"><meta property="og:description" content="In software engineering, Structural Design Patterns deal with the relationship between object & classes i.e. how object & classes interact or build a relationship in a manner suitable to the situation. The Structural Design Patterns simplify the structure by identifying relationships. In this article of the Structural Design Patterns, we&rsquo;re going to take a look at the not so complex yet subtle design pattern that is Decorator Design Pattern in Modern C++ due to its extensibility & testability."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/decorator-design-pattern-in-modern-cpp/"><meta property="og:image" content="http://localhost:1313/images/Decorator-Design-Pattern-in-Modern-C-vishal-chovatiya.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-05T00:00:00+00:00"><meta property="article:modified_time" content="2020-04-05T00:00:00+00:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/images/Decorator-Design-Pattern-in-Modern-C-vishal-chovatiya.png"><meta name=twitter:title content="Decorator Design Pattern in Modern C++"><meta name=twitter:description content="In software engineering, Structural Design Patterns deal with the relationship between object & classes i.e. how object & classes interact or build a relationship in a manner suitable to the situation. The Structural Design Patterns simplify the structure by identifying relationships. In this article of the Structural Design Patterns, we&rsquo;re going to take a look at the not so complex yet subtle design pattern that is Decorator Design Pattern in Modern C++ due to its extensibility & testability."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Decorator Design Pattern in Modern C++","item":"http://localhost:1313/posts/decorator-design-pattern-in-modern-cpp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Decorator Design Pattern in Modern C++","name":"Decorator Design Pattern in Modern C\u002b\u002b","description":"In software engineering, Structural Design Patterns deal with the relationship between object \u0026amp; classes i.e. how object \u0026amp; classes interact or build a relationship in a manner suitable to the situation. The Structural Design Patterns simplify the structure by identifying relationships. In this article of the Structural Design Patterns, we\u0026rsquo;re going to take a look at the not so complex yet subtle design pattern that is Decorator Design Pattern in Modern C++ due to its extensibility \u0026amp; testability.","keywords":["benefits-of-decorator-design-pattern","c-decorator-examples","c-decorator-pattern-c11","c-design-patterns","decorator-design-pattern-c","decorator-design-pattern-c-code","decorator-design-pattern-examples-in-c","decorator-design-pattern-in-c","decorator-design-pattern-in-c-example","decorator-design-pattern-in-modern-c","decorator-pattern-c","decorator-pattern-c-example","difference-between-adapter-decorator-design-pattern","difference-between-proxy-decorator-design-pattern","dynamic-decorator","functional-decorator","limitation-of-dynamic-decorator","static-decorator","what-are-the-drawbacks-of-using-the-decorator-design-pattern","when-to-use-the-decorator-design-pattern"],"articleBody":"In software engineering, Structural Design Patterns deal with the relationship between object \u0026 classes i.e. how object \u0026 classes interact or build a relationship in a manner suitable to the situation. The Structural Design Patterns simplify the structure by identifying relationships. In this article of the Structural Design Patterns, we’re going to take a look at the not so complex yet subtle design pattern that is Decorator Design Pattern in Modern C++ due to its extensibility \u0026 testability. It is also known as Wrapper.\nBy the way, If you haven’t check out my other articles on Structural Design Patterns, then here is the list:\nAdapter Bridge Composite Decorator Facade Flyweight Proxy The code snippets you see throughout this series of articles are simplified not sophisticated. So you often see me not using keywords like override, final, public(while inheritance) just to make code compact \u0026 consumable(most of the time) in single standard screen size. I also prefer struct instead of class just to save line by not writing “public:” sometimes and also miss virtual destructor, constructor, copy constructor, prefix std::, deleting dynamic memory, intentionally. I also consider myself a pragmatic person who wants to convey an idea in the simplest way possible rather than the standard way or using Jargons.\nNote:\nIf you stumbled here directly, then I would suggest you go through What is design pattern? first, even if it is trivial. I believe it will encourage you to explore more on this topic. All of this code you encounter in this series of articles are compiled using C++20(though I have used Modern C++ features up to C++17 in most cases). So if you don’t have access to the latest compiler you can use https://wandbox.org/ which has preinstalled boost library as well. Intent To facilitates the additional functionality to objects.\nSometimes we have to augment the functionality of existing objects without rewrite or altering existing code, just to stick to the Open-Closed Principle. This also preserves the Single Responsibility Principle to have extra functionality on the side. Decorator Design Pattern Examples in C++ And to achieve this we have two different variants of Decorator Design Pattern in C++: Dynamic Decorator: Aggregate the decorated object by reference or pointer. Static Decorator: Inherit from the decorated object. Dynamic Decorator struct Shape { virtual operator string() = 0; }; struct Circle : Shape { float m_radius; Circle(const float radius = 0) : m_radius{radius} {} void resize(float factor) { m_radius *= factor; } operator string() { ostringstream oss; oss \u003c\u003c \"A circle of radius \" \u003c\u003c m_radius; return oss.str(); } }; struct Square : Shape { float m_side; Square(const float side = 0) : m_side{side} {} operator string() { ostringstream oss; oss \u003c\u003c \"A square of side \" \u003c\u003c m_side; return oss.str(); } }; So, we have a hierarchy of two different Shapes(i.e. Square \u0026 Circle) \u0026 we want to enhance this hierarchy by adding colour to it. Now we’re suddenly not going to create two other classes e.g. coloured circle \u0026 a coloured square. That would be too much \u0026 not a scalable option. Rather we can just have ColoredShape as follows. struct ColoredShape : Shape { const Shape\u0026 m_shape; string m_color; ColoredShape(const Shape \u0026s, const string \u0026c) : m_shape{s}, m_color{c} {} operator string() { ostringstream oss; oss \u003c\u003c string(const_cast\u003cShape\u0026\u003e(m_shape)) \u003c\u003c \" has the color \" \u003c\u003c m_color; return oss.str(); } }; // we are not changing the base class of existing objects // cannot make, e.g., ColoredSquare, ColoredCircle, etc. int main() { Square square{5}; ColoredShape green_square{square, \"green\"}; cout \u003c\u003c string(square) \u003c\u003c endl \u003c\u003c string(green_square) \u003c\u003c endl; // green_circle.resize(2); // Not available return EXIT_SUCCESS; } Why this is a dynamic decorator?\nBecause you can instantiate the ColoredShape at runtime by providing needed arguments. In other words, you can decide at runtime that which Shape(i.e. Circle or Square) is going to be coloured.\nYou can even mix the decorators as follows: struct TransparentShape : Shape { const Shape\u0026 m_shape; uint8_t m_transparency; TransparentShape(const Shape\u0026 s, const uint8_t t) : m_shape{s}, m_transparency{t} {} operator string() { ostringstream oss; oss \u003c\u003c string(const_cast\u003cShape\u0026\u003e(m_shape)) \u003c\u003c \" has \" \u003c\u003c static_cast\u003cfloat\u003e(m_transparency) / 255.f * 100.f \u003c\u003c \"% transparency\"; return oss.str(); } }; int main() { TransparentShape TransparentShape{ColoredShape{Square{5}, \"green\"}, 51}; cout \u003c\u003c string(TransparentShape) \u003c\u003c endl; return EXIT_SUCCESS; } Limitation of Dynamic Decorator If you look at the definition of Circle, You can see that the circle has a method called resize() we can not use this method as we did aggregation on-base interface Shape \u0026 bound by the only method exposed in it.\nStatic Decorator The dynamic decorator is great if you don’t know which object you are going to decorate and you want to be able to pick them at runtime but sometimes you know the decorator you want at compile time in which case you can use a combination of C++ templates \u0026 inheritance. template \u003cclass T\u003e // Note: `class`, not typename struct ColoredShape : T { static_assert(is_base_of\u003cShape, T\u003e::value, \"Invalid template argument\"); // Compile time safety string m_color; template \u003ctypename... Args\u003e ColoredShape(const string \u0026c, Args \u0026\u0026... args) : m_color(c), T(std::forward\u003cArgs\u003e(args)...) { } operator string() { ostringstream oss; oss \u003c\u003c T::operator string() \u003c\u003c \" has the color \" \u003c\u003c m_color; return oss.str(); } }; template \u003ctypename T\u003e struct TransparentShape : T { uint8_t m_transparency; template \u003ctypename... Args\u003e TransparentShape(const uint8_t t, Args... args) : m_transparency{t}, T(std::forward\u003cArgs\u003e(args)...) { } operator string() { ostringstream oss; oss \u003c\u003c T::operator string() \u003c\u003c \" has \" \u003c\u003c static_cast\u003cfloat\u003e(m_transparency) / 255.f * 100.f \u003c\u003c \"% transparency\"; return oss.str(); } }; int main() { ColoredShape\u003cCircle\u003e green_circle{\"green\", 5}; green_circle.resize(2); cout \u003c\u003c string(green_circle) \u003c\u003c endl; // Mixing decorators TransparentShape\u003cColoredShape\u003cCircle\u003e\u003e green_trans_circle{51, \"green\", 5}; green_trans_circle.resize(2); cout \u003c\u003c string(green_trans_circle) \u003c\u003c endl; return EXIT_SUCCESS; } As you can see we can now call the resize()method which was the limitation of Dynamic Decorator. You can even mix the decorators as we did earlier. So essentially what this example demonstrates is that if you’re prepared to give up on the dynamic composition nature of the decorator and if you’re prepared to define all the decorators at compile time you get the added benefit of using inheritance. And that way you actually get the members of whatever object you are decorating being accessible through the decorator \u0026 mixed decorator. Functional Approach to Decorator Design Pattern using Modern C++ Up until now, we were talking about the Decorator Design Pattern which decorates over a class but you can do the same for functions. Following is a typical logger example for the same: // Need partial specialization for this to work template \u003ctypename T\u003e struct Logger; // Return type and argument list template \u003ctypename R, typename... Args\u003e struct Logger\u003cR(Args...)\u003e { function\u003cR(Args...)\u003e m_func; string m_name; Logger(function\u003cR(Args...)\u003e f, const string \u0026n) : m_func{f}, m_name{n} { } R operator()(Args... args) { cout \u003c\u003c \"Entering \" \u003c\u003c m_name \u003c\u003c endl; R result = m_func(args...); cout \u003c\u003c \"Exiting \" \u003c\u003c m_name \u003c\u003c endl; return result; } }; template \u003ctypename R, typename... Args\u003e auto make_logger(R (*func)(Args...), const string \u0026name) { return Logger\u003cR(Args...)\u003e(std::function\u003cR(Args...)\u003e(func), name); } double add(double a, double b) { return a + b; } int main() { auto logged_add = make_logger(add, \"Add\"); auto result = logged_add(2, 3); return EXIT_SUCCESS; } Above example may seem a bit complex to you but if you have a clear understanding of variadic template then it won’t take more than 30 seconds to understand what’s going on here. Benefits of Decorator Design Pattern Decorator facilitates augmentation of the functionality for an existing object at run-time \u0026 compile time. Decorator also provides flexibility for adding any number of decorators, in any order \u0026 mixing it. Decorators are a nice solution to permutation issues because you can wrap a component with any number of Decorators. It is a wise choice to apply the Decorator Design Pattern for already shipped code. Because it enables backward compatibility of application \u0026 less unit level testing as changes do not affect other parts of code. Summary by FAQs When to use the Decorator Design Pattern?\nEmploy the Decorator Design Pattern when you need to be able to assign extra behaviours to objects at runtime without breaking the code that uses these objects. When the class has final keyword which means the class is not further inheritable. In such cases, the Decorator Design Pattern may come to rescue. What are the drawbacks of using the Decorator Design Pattern?\nDecorators can complicate the process of instantiating the component because you not only have to instantiate the component but wrap it in a number of Decorators. Overuse of Decorator Design Pattern may complicate the system in terms of both i.e. Maintainance \u0026 learning curve. Difference between Adapter \u0026 Decorator Design Pattern?\nAdapter changes the interface of an existing object Decorator enhances the interface of an existing object Difference between Proxy \u0026 Decorator Design Pattern?\nProxy provides a somewhat same or easy interface Decorator provides enhanced interface ","wordCount":"1468","inLanguage":"en","image":"http://localhost:1313/images/Decorator-Design-Pattern-in-Modern-C-vishal-chovatiya.png","datePublished":"2020-04-05T00:00:00Z","dateModified":"2020-04-05T00:00:00Z","author":{"@type":"Person","name":"Vishal Chovatiya"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/decorator-design-pattern-in-modern-cpp/"},"publisher":{"@type":"Organization","name":"Vishal Chovatiya","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Vishal Chovatiya (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Vishal Chovatiya</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/pages/vishal-chovatiya title="About Me"><span>About Me</span></a></li><li><a href=http://localhost:1313/pages/start-here title="Start Here"><span>Start Here</span></a></li><li><a href=http://localhost:1313/posts/ title=Latest><span>Latest</span></a></li><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Decorator Design Pattern in Modern C++</h1><div class=post-meta><span title='2020-04-05 00:00:00 +0000 UTC'>April 5, 2020</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1468 words&nbsp;·&nbsp;Vishal Chovatiya&nbsp;|&nbsp;<a href=https://github.com/vishalchovatiya/blog/vishalchovatiya/content/posts/decorator-design-pattern-in-modern-cpp.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=http://localhost:1313/images/Decorator-Design-Pattern-in-Modern-C-vishal-chovatiya.png alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#intent>Intent</a></li><li><a href=#decorator-design-pattern-examples-in-c>Decorator Design Pattern Examples in C++</a><ul><li><a href=#dynamic-decorator>Dynamic Decorator</a></li><li><a href=#static-decorator>Static Decorator</a></li><li><a href=#functional-approach-to-decorator-design-pattern-using-modern-c>Functional Approach to Decorator Design Pattern using Modern C++</a></li></ul></li><li><a href=#benefits-of-decorator-design-pattern>Benefits of Decorator Design Pattern</a></li><li><a href=#summary-by-faqs>Summary by FAQs</a></li></ul></nav></div></details></div><div class=post-content><p>In software engineering, Structural Design Patterns deal with the relationship between object & classes i.e. how object & classes interact or build a relationship in a manner suitable to the situation. The Structural Design Patterns simplify the structure by identifying relationships. In this article of the Structural Design Patterns, we&rsquo;re going to take a look at the not so complex yet subtle design pattern that is Decorator Design Pattern in Modern C++ due to its extensibility & testability. It is also <strong><em>known as Wrapper</em></strong>.</p><p>By the way, If you haven’t check out my other articles on Structural Design Patterns, then here is the list:</p><ol><li><a href=/posts//adapter-design-pattern-in-modern-cpp/>Adapter</a></li><li><a href=/posts//bridge-design-pattern-in-modern-cpp/>Bridge</a></li><li><a href=/posts//composite-design-pattern-in-modern-cpp/>Composite</a></li><li><a href=/posts//decorator-design-pattern-in-modern-cpp/>Decorator</a></li><li><a href=/posts//facade-design-pattern-in-modern-cpp/>Facade</a></li><li><a href=/posts//flyweight-design-pattern-in-modern-cpp/>Flyweight</a></li><li><a href=/posts//proxy-design-pattern-in-modern-cpp/>Proxy</a></li></ol><p>The code snippets you see throughout this series of articles are simplified not sophisticated. So you often see me not using keywords like <code>override</code>, <code>final</code>, <code>public</code>(while inheritance) just to make code compact & consumable(most of the time) in single standard screen size. I also prefer <code>struct</code> instead of <code>class</code> just to save line by not writing &ldquo;<code>public:</code>&rdquo; sometimes and also miss <a href=/posts//part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works/>virtual destructor</a>, constructor, <a href=/posts//all-about-copy-constructor-in-cpp-with-example/>copy constructor</a>, prefix <code>std::</code>, deleting dynamic memory, intentionally. I also consider myself a pragmatic person who wants to convey an idea in the simplest way possible rather than the standard way or using Jargons.</p><p><strong><em>Note:</em></strong></p><ul><li>If you stumbled here directly, then I would suggest you go through <a href=/posts//what-is-design-pattern/>What is design pattern?</a> first, even if it is trivial. I believe it will encourage you to explore more on this topic.</li><li>All of this code you encounter in this series of articles are compiled using C++20(though I have used <a href=/posts//21-new-features-of-modern-cpp-to-use-in-your-project/>Modern C++</a> features up to C++17 in most cases). So if you don&rsquo;t have access to the latest compiler you can use <a href=https://wandbox.org/>https://wandbox.org/</a> which has preinstalled boost library as well.</li></ul><h2 id=intent>Intent<a hidden class=anchor aria-hidden=true href=#intent>#</a></h2><blockquote><p><strong><em>To facilitates the additional functionality to objects.</em></strong></p></blockquote><ul><li>Sometimes we have to augment the functionality of existing objects without rewrite or altering existing code, just to stick to the <a href=/posts/open-closed-principle-in-cpp-solid-as-a-rock/>Open-Closed Principle</a>. This also preserves the <a href=/posts/single-responsibility-principle-in-cpp-solid-as-a-rock/>Single Responsibility Principle</a> to have extra functionality on the side.</li></ul><h2 id=decorator-design-pattern-examples-in-c>Decorator Design Pattern Examples in C++<a hidden class=anchor aria-hidden=true href=#decorator-design-pattern-examples-in-c>#</a></h2><ul><li>And to achieve this we have two different variants of Decorator Design Pattern in C++:<ol><li><strong>Dynamic Decorator</strong>: Aggregate the decorated object by reference or pointer.</li><li><strong>Static Decorator</strong>: Inherit from the decorated object.</li></ol></li></ul><h3 id=dynamic-decorator>Dynamic Decorator<a hidden class=anchor aria-hidden=true href=#dynamic-decorator>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>struct</span> <span class=nc>Shape</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=k>operator</span> <span class=nf>string</span><span class=p>()</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>Circle</span> <span class=o>:</span> <span class=n>Shape</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>float</span>   <span class=n>m_radius</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Circle</span><span class=p>(</span><span class=k>const</span> <span class=kt>float</span> <span class=n>radius</span> <span class=o>=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>:</span> <span class=n>m_radius</span><span class=p>{</span><span class=n>radius</span><span class=p>}</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>resize</span><span class=p>(</span><span class=kt>float</span> <span class=n>factor</span><span class=p>)</span> <span class=p>{</span> <span class=n>m_radius</span> <span class=o>*=</span> <span class=n>factor</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>operator</span> <span class=nf>string</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ostringstream</span> <span class=n>oss</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>oss</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;A circle of radius &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>m_radius</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>oss</span><span class=p>.</span><span class=n>str</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>Square</span> <span class=o>:</span> <span class=n>Shape</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>float</span>   <span class=n>m_side</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Square</span><span class=p>(</span><span class=k>const</span> <span class=kt>float</span> <span class=n>side</span> <span class=o>=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>:</span> <span class=n>m_side</span><span class=p>{</span><span class=n>side</span><span class=p>}</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>operator</span> <span class=nf>string</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ostringstream</span> <span class=n>oss</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>oss</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;A square of side &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>m_side</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>oss</span><span class=p>.</span><span class=n>str</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><ul><li>So, we have a hierarchy of two different <code>Shape</code>s(i.e. <code>Square</code> & <code>Circle</code>) & we want to enhance this hierarchy by adding colour to it. Now we&rsquo;re suddenly not going to create two other classes e.g. coloured circle & a coloured square. That would be too much & not a scalable option.</li><li>Rather we can just have <code>ColoredShape</code> as follows.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>struct</span> <span class=nc>ColoredShape</span> <span class=o>:</span> <span class=n>Shape</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=n>Shape</span><span class=o>&amp;</span>    <span class=n>m_shape</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>string</span>          <span class=n>m_color</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ColoredShape</span><span class=p>(</span><span class=k>const</span> <span class=n>Shape</span> <span class=o>&amp;</span><span class=n>s</span><span class=p>,</span> <span class=k>const</span> <span class=n>string</span> <span class=o>&amp;</span><span class=n>c</span><span class=p>)</span> <span class=o>:</span> <span class=n>m_shape</span><span class=p>{</span><span class=n>s</span><span class=p>},</span> <span class=n>m_color</span><span class=p>{</span><span class=n>c</span><span class=p>}</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>operator</span> <span class=nf>string</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ostringstream</span> <span class=n>oss</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>oss</span> <span class=o>&lt;&lt;</span> <span class=n>string</span><span class=p>(</span><span class=k>const_cast</span><span class=o>&lt;</span><span class=n>Shape</span><span class=o>&amp;&gt;</span><span class=p>(</span><span class=n>m_shape</span><span class=p>))</span> <span class=o>&lt;&lt;</span> <span class=s>&#34; has the color &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>m_color</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>oss</span><span class=p>.</span><span class=n>str</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// we are not changing the base class of existing objects
</span></span></span><span class=line><span class=cl><span class=c1>// cannot make, e.g., ColoredSquare, ColoredCircle, etc.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Square</span> <span class=n>square</span><span class=p>{</span><span class=mi>5</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>ColoredShape</span> <span class=n>green_square</span><span class=p>{</span><span class=n>square</span><span class=p>,</span> <span class=s>&#34;green&#34;</span><span class=p>};</span>    
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>string</span><span class=p>(</span><span class=n>square</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span> <span class=o>&lt;&lt;</span> <span class=n>string</span><span class=p>(</span><span class=n>green_square</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// green_circle.resize(2); // Not available
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong><em>Why this is a dynamic decorator?</em></strong><br>Because you can instantiate the <code>ColoredShape</code> at runtime by providing needed arguments. In other words, you can decide at runtime that which <code>Shape</code>(i.e. <code>Circle</code> or <code>Square</code>) is going to be coloured.</p><ul><li>You can even mix the decorators as follows:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>struct</span> <span class=nc>TransparentShape</span> <span class=o>:</span> <span class=n>Shape</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=n>Shape</span><span class=o>&amp;</span>    <span class=n>m_shape</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint8_t</span>         <span class=n>m_transparency</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>TransparentShape</span><span class=p>(</span><span class=k>const</span> <span class=n>Shape</span><span class=o>&amp;</span> <span class=n>s</span><span class=p>,</span> <span class=k>const</span> <span class=kt>uint8_t</span> <span class=n>t</span><span class=p>)</span> <span class=o>:</span> <span class=n>m_shape</span><span class=p>{</span><span class=n>s</span><span class=p>},</span> <span class=n>m_transparency</span><span class=p>{</span><span class=n>t</span><span class=p>}</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>operator</span> <span class=nf>string</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ostringstream</span> <span class=n>oss</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>oss</span> <span class=o>&lt;&lt;</span> <span class=n>string</span><span class=p>(</span><span class=k>const_cast</span><span class=o>&lt;</span><span class=n>Shape</span><span class=o>&amp;&gt;</span><span class=p>(</span><span class=n>m_shape</span><span class=p>))</span> <span class=o>&lt;&lt;</span> <span class=s>&#34; has &#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;&lt;</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=kt>float</span><span class=o>&gt;</span><span class=p>(</span><span class=n>m_transparency</span><span class=p>)</span> <span class=o>/</span> <span class=mf>255.f</span> <span class=o>*</span> <span class=mf>100.f</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;&lt;</span> <span class=s>&#34;% transparency&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>oss</span><span class=p>.</span><span class=n>str</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>TransparentShape</span> <span class=n>TransparentShape</span><span class=p>{</span><span class=n>ColoredShape</span><span class=p>{</span><span class=n>Square</span><span class=p>{</span><span class=mi>5</span><span class=p>},</span> <span class=s>&#34;green&#34;</span><span class=p>},</span> <span class=mi>51</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>string</span><span class=p>(</span><span class=n>TransparentShape</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=limitation-of-dynamic-decorator>Limitation of Dynamic Decorator<a hidden class=anchor aria-hidden=true href=#limitation-of-dynamic-decorator>#</a></h4><p>If you look at the definition of <code>Circle</code>, You can see that the circle has a method called <code>resize()</code> we can not use this method as we did aggregation on-base interface <code>Shape</code> & bound by the only method exposed in it.</p><h3 id=static-decorator>Static Decorator<a hidden class=anchor aria-hidden=true href=#static-decorator>#</a></h3><ul><li>The dynamic decorator is great if you don&rsquo;t know which object you are going to decorate and you want to be able to pick them at runtime but sometimes you know the decorator you want at compile time in which case you can use a combination of <a href=/posts/c-template-a-quick-uptodate-look/>C++ templates</a> & inheritance.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>template</span> <span class=o>&lt;</span><span class=k>class</span> <span class=nc>T</span><span class=o>&gt;</span>  <span class=c1>// Note: `class`, not typename
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>struct</span> <span class=nc>ColoredShape</span> <span class=o>:</span> <span class=n>T</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>static_assert</span><span class=p>(</span><span class=n>is_base_of</span><span class=o>&lt;</span><span class=n>Shape</span><span class=p>,</span> <span class=n>T</span><span class=o>&gt;::</span><span class=n>value</span><span class=p>,</span> <span class=s>&#34;Invalid template argument&#34;</span><span class=p>);</span> <span class=c1>// Compile time safety
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>string</span>      <span class=n>m_color</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span><span class=p>...</span> <span class=n>Args</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>ColoredShape</span><span class=p>(</span><span class=k>const</span> <span class=n>string</span> <span class=o>&amp;</span><span class=n>c</span><span class=p>,</span> <span class=n>Args</span> <span class=o>&amp;&amp;</span><span class=p>...</span> <span class=n>args</span><span class=p>)</span> <span class=o>:</span> <span class=n>m_color</span><span class=p>(</span><span class=n>c</span><span class=p>),</span> <span class=n>T</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>forward</span><span class=o>&lt;</span><span class=n>Args</span><span class=o>&gt;</span><span class=p>(</span><span class=n>args</span><span class=p>)...)</span> <span class=p>{</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>operator</span> <span class=nf>string</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ostringstream</span> <span class=n>oss</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>oss</span> <span class=o>&lt;&lt;</span> <span class=n>T</span><span class=o>::</span><span class=k>operator</span> <span class=n>string</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34; has the color &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>m_color</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>oss</span><span class=p>.</span><span class=n>str</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=n>T</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>TransparentShape</span> <span class=o>:</span> <span class=n>T</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint8_t</span>     <span class=n>m_transparency</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span><span class=p>...</span> <span class=n>Args</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>TransparentShape</span><span class=p>(</span><span class=k>const</span> <span class=kt>uint8_t</span> <span class=n>t</span><span class=p>,</span> <span class=n>Args</span><span class=p>...</span> <span class=n>args</span><span class=p>)</span> <span class=o>:</span> <span class=n>m_transparency</span><span class=p>{</span><span class=n>t</span><span class=p>},</span> <span class=n>T</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>forward</span><span class=o>&lt;</span><span class=n>Args</span><span class=o>&gt;</span><span class=p>(</span><span class=n>args</span><span class=p>)...)</span> <span class=p>{</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>operator</span> <span class=nf>string</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ostringstream</span> <span class=n>oss</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>oss</span> <span class=o>&lt;&lt;</span> <span class=n>T</span><span class=o>::</span><span class=k>operator</span> <span class=n>string</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34; has &#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;&lt;</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=kt>float</span><span class=o>&gt;</span><span class=p>(</span><span class=n>m_transparency</span><span class=p>)</span> <span class=o>/</span> <span class=mf>255.f</span> <span class=o>*</span> <span class=mf>100.f</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;&lt;</span> <span class=s>&#34;% transparency&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>oss</span><span class=p>.</span><span class=n>str</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ColoredShape</span><span class=o>&lt;</span><span class=n>Circle</span><span class=o>&gt;</span> <span class=n>green_circle</span><span class=p>{</span><span class=s>&#34;green&#34;</span><span class=p>,</span> <span class=mi>5</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>green_circle</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>string</span><span class=p>(</span><span class=n>green_circle</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Mixing decorators
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>TransparentShape</span><span class=o>&lt;</span><span class=n>ColoredShape</span><span class=o>&lt;</span><span class=n>Circle</span><span class=o>&gt;&gt;</span> <span class=n>green_trans_circle</span><span class=p>{</span><span class=mi>51</span><span class=p>,</span> <span class=s>&#34;green&#34;</span><span class=p>,</span> <span class=mi>5</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>green_trans_circle</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=n>string</span><span class=p>(</span><span class=n>green_trans_circle</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>As you can see we can now call the <code>resize()</code>method which was the limitation of Dynamic Decorator. You can even mix the decorators as we did earlier.</li><li>So essentially what this example demonstrates is that if you&rsquo;re prepared to give up on the dynamic composition nature of the decorator and if you&rsquo;re prepared to define all the decorators at compile time you get the added benefit of using inheritance.</li><li>And that way you actually get the members of whatever object you are decorating being accessible through the decorator & mixed decorator.</li></ul><h3 id=functional-approach-to-decorator-design-pattern-using-modern-c>Functional Approach to Decorator Design Pattern using Modern C++<a hidden class=anchor aria-hidden=true href=#functional-approach-to-decorator-design-pattern-using-modern-c>#</a></h3><ul><li>Up until now, we were talking about the Decorator Design Pattern which decorates over a class but you can do the same for functions. Following is a typical logger example for the same:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>// Need partial specialization for this to work
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=n>T</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>Logger</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Return type and argument list
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=n>R</span><span class=p>,</span> <span class=k>typename</span><span class=p>...</span> <span class=n>Args</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>Logger</span><span class=o>&lt;</span><span class=n>R</span><span class=p>(</span><span class=n>Args</span><span class=p>...)</span><span class=o>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>function</span><span class=o>&lt;</span><span class=n>R</span><span class=p>(</span><span class=n>Args</span><span class=p>...)</span><span class=o>&gt;</span>    <span class=n>m_func</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>string</span>                  <span class=n>m_name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Logger</span><span class=p>(</span><span class=n>function</span><span class=o>&lt;</span><span class=n>R</span><span class=p>(</span><span class=n>Args</span><span class=p>...)</span><span class=o>&gt;</span> <span class=n>f</span><span class=p>,</span> <span class=k>const</span> <span class=n>string</span> <span class=o>&amp;</span><span class=n>n</span><span class=p>)</span> <span class=o>:</span> <span class=n>m_func</span><span class=p>{</span><span class=n>f</span><span class=p>},</span> <span class=n>m_name</span><span class=p>{</span><span class=n>n</span><span class=p>}</span> <span class=p>{</span> <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>R</span> <span class=nf>operator</span><span class=p>()(</span><span class=n>Args</span><span class=p>...</span> <span class=n>args</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Entering &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>m_name</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>R</span> <span class=n>result</span> <span class=o>=</span> <span class=n>m_func</span><span class=p>(</span><span class=n>args</span><span class=p>...);</span>
</span></span><span class=line><span class=cl>        <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Exiting &#34;</span> <span class=o>&lt;&lt;</span> <span class=n>m_name</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=n>R</span><span class=p>,</span> <span class=k>typename</span><span class=p>...</span> <span class=n>Args</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>auto</span> <span class=n>make_logger</span><span class=p>(</span><span class=n>R</span> <span class=p>(</span><span class=o>*</span><span class=n>func</span><span class=p>)(</span><span class=n>Args</span><span class=p>...),</span> <span class=k>const</span> <span class=n>string</span> <span class=o>&amp;</span><span class=n>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Logger</span><span class=o>&lt;</span><span class=n>R</span><span class=p>(</span><span class=n>Args</span><span class=p>...)</span><span class=o>&gt;</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>function</span><span class=o>&lt;</span><span class=n>R</span><span class=p>(</span><span class=n>Args</span><span class=p>...)</span><span class=o>&gt;</span><span class=p>(</span><span class=n>func</span><span class=p>),</span> <span class=n>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>double</span> <span class=nf>add</span><span class=p>(</span><span class=kt>double</span> <span class=n>a</span><span class=p>,</span> <span class=kt>double</span> <span class=n>b</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=n>a</span> <span class=o>+</span> <span class=n>b</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=n>logged_add</span> <span class=o>=</span> <span class=n>make_logger</span><span class=p>(</span><span class=n>add</span><span class=p>,</span> <span class=s>&#34;Add&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=n>result</span> <span class=o>=</span> <span class=n>logged_add</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>Above example may seem a bit complex to you but if you have a clear understanding of <a href=/posts/variadic-template-cpp-implementing-unsophisticated-tuple/>variadic template</a> then it won&rsquo;t take more than 30 seconds to understand what&rsquo;s going on here.</li></ul><h2 id=benefits-of-decorator-design-pattern>Benefits of Decorator Design Pattern<a hidden class=anchor aria-hidden=true href=#benefits-of-decorator-design-pattern>#</a></h2><ol><li>Decorator facilitates augmentation of the functionality for an existing object at run-time & compile time.</li><li>Decorator also provides flexibility for adding any number of decorators, in any order & mixing it.</li><li>Decorators are a nice solution to permutation issues because you can wrap a component with any number of Decorators.</li><li>It is a wise choice to apply the Decorator Design Pattern for already shipped code. Because it enables backward compatibility of application & less unit level testing as changes do not affect other parts of code.</li></ol><h2 id=summary-by-faqs>Summary by FAQs<a hidden class=anchor aria-hidden=true href=#summary-by-faqs>#</a></h2><p><strong>When to use the Decorator Design Pattern?</strong></p><ul><li>Employ the Decorator Design Pattern when you need to be able to assign extra behaviours to objects at runtime without breaking the code that uses these objects.</li><li>When the class has <a href=https://en.cppreference.com/w/cpp/keyword/final>final</a> keyword which means the class is not further inheritable. In such cases, the Decorator Design Pattern may come to rescue.</li></ul><p><strong>What are the drawbacks of using the Decorator Design Pattern?</strong></p><ul><li>Decorators can complicate the process of instantiating the component because you not only have to instantiate the component but wrap it in a number of Decorators.</li><li>Overuse of Decorator Design Pattern may complicate the system in terms of both i.e. Maintainance & learning curve.</li></ul><p><strong>Difference between Adapter & Decorator Design Pattern?</strong></p><ul><li><strong>Adapter changes the interface</strong> of an existing object</li><li><strong>Decorator enhances the interface</strong> of an existing object</li></ul><p><strong>Difference between Proxy & Decorator Design Pattern?</strong></p><ul><li><strong>Proxy</strong> provides a somewhat same or <strong>easy interface</strong></li><li><strong>Decorator</strong> provides <strong>enhanced interface</strong></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/benefits-of-decorator-design-pattern/>Benefits-of-Decorator-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/c-decorator-examples/>C-Decorator-Examples</a></li><li><a href=http://localhost:1313/tags/c-decorator-pattern-c11/>C-Decorator-Pattern-C11</a></li><li><a href=http://localhost:1313/tags/c-design-patterns/>C-Design-Patterns</a></li><li><a href=http://localhost:1313/tags/decorator-design-pattern-c/>Decorator-Design-Pattern-C</a></li><li><a href=http://localhost:1313/tags/decorator-design-pattern-c-code/>Decorator-Design-Pattern-C-Code</a></li><li><a href=http://localhost:1313/tags/decorator-design-pattern-examples-in-c/>Decorator-Design-Pattern-Examples-in-C</a></li><li><a href=http://localhost:1313/tags/decorator-design-pattern-in-c/>Decorator-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/decorator-design-pattern-in-c-example/>Decorator-Design-Pattern-in-C-Example</a></li><li><a href=http://localhost:1313/tags/decorator-design-pattern-in-modern-c/>Decorator-Design-Pattern-in-Modern-C</a></li><li><a href=http://localhost:1313/tags/decorator-pattern-c/>Decorator-Pattern-C</a></li><li><a href=http://localhost:1313/tags/decorator-pattern-c-example/>Decorator-Pattern-C-Example</a></li><li><a href=http://localhost:1313/tags/difference-between-adapter-decorator-design-pattern/>Difference-Between-Adapter-Decorator-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/difference-between-proxy-decorator-design-pattern/>Difference-Between-Proxy-Decorator-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/dynamic-decorator/>Dynamic-Decorator</a></li><li><a href=http://localhost:1313/tags/functional-decorator/>Functional-Decorator</a></li><li><a href=http://localhost:1313/tags/limitation-of-dynamic-decorator/>Limitation-of-Dynamic-Decorator</a></li><li><a href=http://localhost:1313/tags/static-decorator/>Static-Decorator</a></li><li><a href=http://localhost:1313/tags/what-are-the-drawbacks-of-using-the-decorator-design-pattern/>What-Are-the-Drawbacks-of-Using-the-Decorator-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/when-to-use-the-decorator-design-pattern/>When-to-Use-the-Decorator-Design-Pattern</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/composite-design-pattern-in-modern-cpp/><span class=title>« Prev</span><br><span>Composite Design Pattern in Modern C++</span>
</a><a class=next href=http://localhost:1313/posts/facade-design-pattern-in-modern-cpp/><span class=title>Next »</span><br><span>Facade Design Pattern in Modern C++</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Decorator Design Pattern in Modern C++ on x" href="https://x.com/intent/tweet/?text=Decorator%20Design%20Pattern%20in%20Modern%20C%2b%2b&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdecorator-design-pattern-in-modern-cpp%2f&amp;hashtags=benefits-of-decorator-design-pattern%2cc-decorator-examples%2cc-decorator-pattern-c11%2cc-design-patterns%2cdecorator-design-pattern-c%2cdecorator-design-pattern-c-code%2cdecorator-design-pattern-examples-in-c%2cdecorator-design-pattern-in-c%2cdecorator-design-pattern-in-c-example%2cdecorator-design-pattern-in-modern-c%2cdecorator-pattern-c%2cdecorator-pattern-c-example%2cdifference-between-adapter-decorator-design-pattern%2cdifference-between-proxy-decorator-design-pattern%2cdynamic-decorator%2cfunctional-decorator%2climitation-of-dynamic-decorator%2cstatic-decorator%2cwhat-are-the-drawbacks-of-using-the-decorator-design-pattern%2cwhen-to-use-the-decorator-design-pattern"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Decorator Design Pattern in Modern C++ on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdecorator-design-pattern-in-modern-cpp%2f&amp;title=Decorator%20Design%20Pattern%20in%20Modern%20C%2b%2b&amp;summary=Decorator%20Design%20Pattern%20in%20Modern%20C%2b%2b&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fdecorator-design-pattern-in-modern-cpp%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Decorator Design Pattern in Modern C++ on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdecorator-design-pattern-in-modern-cpp%2f&title=Decorator%20Design%20Pattern%20in%20Modern%20C%2b%2b"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Decorator Design Pattern in Modern C++ on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fdecorator-design-pattern-in-modern-cpp%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Decorator Design Pattern in Modern C++ on whatsapp" href="https://api.whatsapp.com/send?text=Decorator%20Design%20Pattern%20in%20Modern%20C%2b%2b%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fdecorator-design-pattern-in-modern-cpp%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Decorator Design Pattern in Modern C++ on telegram" href="https://telegram.me/share/url?text=Decorator%20Design%20Pattern%20in%20Modern%20C%2b%2b&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fdecorator-design-pattern-in-modern-cpp%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Decorator Design Pattern in Modern C++ on ycombinator" href="https://news.ycombinator.com/submitlink?t=Decorator%20Design%20Pattern%20in%20Modern%20C%2b%2b&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fdecorator-design-pattern-in-modern-cpp%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Vishal Chovatiya</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>