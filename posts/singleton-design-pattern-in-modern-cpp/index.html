<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Singleton Design Pattern in Modern C++ | Vishal Chovatiya</title>
<meta name=keywords content="benefits-of-singleton-design-pattern,c-class-singleton,c-singleton,c-singleton-class-example,c-singleton-design-pattern,c-singleton-example,c-singleton-implementation,c-singleton-pattern-example,c-singleton-template,cpp-singleton,design-patterns-singleton-c-destructor,example-of-singleton-design-pattern-in-c,how-to-implement-singleton-design-pattern-in-c,multiton-design-pattern,real-time-example-of-singleton-class-in-c,real-time-example-of-singleton-design-pattern-in-c,singleton-c-class,singleton-c-example,singleton-class-c,singleton-class-c-example,singleton-class-design-pattern-in-c,singleton-class-example-in-c,singleton-class-in-cpp,singleton-constructor-c,singleton-design-pattern-c-11,singleton-design-pattern-c-copy-constructor,singleton-design-pattern-c-implementation,singleton-design-pattern-c-inheritance,singleton-design-pattern-c-tutorial,singleton-design-pattern-examples-in-c,singleton-design-pattern-in-c,singleton-design-pattern-in-c-code,singleton-design-pattern-in-c-example,singleton-design-pattern-in-c-reference,singleton-design-pattern-in-c-simple-example,singleton-design-pattern-in-c-with-example,singleton-design-pattern-in-cpp,singleton-design-pattern-in-modern-c,singleton-design-pattern-program-c,singleton-design-pattern-with-dependency-injection,singleton-object-c,singleton-pattern-c-2,singleton-pattern-c,the-problem-of-testability-with-singleton,use-of-singleton-class-in-c,use-of-singleton-design-pattern-in-c,what-are-the-limitations-of-singleton-design-pattern-in-c,what-is-singleton-design-pattern-in-c,what-is-so-bad-about-the-singleton-design-pattern,what-is-the-correct-way-to-implement-singleton-design-pattern,what-is-the-use-of-singleton-design-pattern-in-c,when-should-you-use-the-singleton-design-pattern,why-singleton-design-pattern-in-c,why-we-use-singleton-design-pattern-in-c"><meta name=description content="In software engineering, Creational Design Patterns deal with object creation mechanisms, i.e. try to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. In this article of the Creational Design Patterns, we&rsquo;re going to take a look at the much-hated & commonly asked design pattern in a programming interview. That is Singleton Design Pattern in Modern C++ which criticizes for its extensibility & testability."><meta name=author content="Vishal Chovatiya"><link rel=canonical href=http://localhost:1313/posts/singleton-design-pattern-in-modern-cpp/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/images/trident_favicon.webp><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/images/trident_favicon.webp><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/images/trident_favicon.webp><link rel=apple-touch-icon href=http://localhost:1313/images/trident_favicon.webp><link rel=mask-icon href=http://localhost:1313/images/trident_favicon.webp><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/singleton-design-pattern-in-modern-cpp/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Singleton Design Pattern in Modern C++"><meta property="og:description" content="In software engineering, Creational Design Patterns deal with object creation mechanisms, i.e. try to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. In this article of the Creational Design Patterns, we&rsquo;re going to take a look at the much-hated & commonly asked design pattern in a programming interview. That is Singleton Design Pattern in Modern C++ which criticizes for its extensibility & testability."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/singleton-design-pattern-in-modern-cpp/"><meta property="og:image" content="http://localhost:1313/images/Singleton-Design-Pattern-in-Modern-C-vishal-chovatiya.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-06T00:00:00+00:00"><meta property="article:modified_time" content="2020-04-06T00:00:00+00:00"><meta property="og:site_name" content="Vishal Chovatiya"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/images/Singleton-Design-Pattern-in-Modern-C-vishal-chovatiya.png"><meta name=twitter:title content="Singleton Design Pattern in Modern C++"><meta name=twitter:description content="In software engineering, Creational Design Patterns deal with object creation mechanisms, i.e. try to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. In this article of the Creational Design Patterns, we&rsquo;re going to take a look at the much-hated & commonly asked design pattern in a programming interview. That is Singleton Design Pattern in Modern C++ which criticizes for its extensibility & testability."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Singleton Design Pattern in Modern C++","item":"http://localhost:1313/posts/singleton-design-pattern-in-modern-cpp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Singleton Design Pattern in Modern C++","name":"Singleton Design Pattern in Modern C\u002b\u002b","description":"In software engineering, Creational Design Patterns deal with object creation mechanisms, i.e. try to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. In this article of the Creational Design Patterns, we\u0026rsquo;re going to take a look at the much-hated \u0026amp; commonly asked design pattern in a programming interview. That is Singleton Design Pattern in Modern C++ which criticizes for its extensibility \u0026amp; testability.","keywords":["benefits-of-singleton-design-pattern","c-class-singleton","c-singleton","c-singleton-class-example","c-singleton-design-pattern","c-singleton-example","c-singleton-implementation","c-singleton-pattern-example","c-singleton-template","cpp-singleton","design-patterns-singleton-c-destructor","example-of-singleton-design-pattern-in-c","how-to-implement-singleton-design-pattern-in-c","multiton-design-pattern","real-time-example-of-singleton-class-in-c","real-time-example-of-singleton-design-pattern-in-c","singleton-c-class","singleton-c-example","singleton-class-c","singleton-class-c-example","singleton-class-design-pattern-in-c","singleton-class-example-in-c","singleton-class-in-cpp","singleton-constructor-c","singleton-design-pattern-c-11","singleton-design-pattern-c-copy-constructor","singleton-design-pattern-c-implementation","singleton-design-pattern-c-inheritance","singleton-design-pattern-c-tutorial","singleton-design-pattern-examples-in-c","singleton-design-pattern-in-c","singleton-design-pattern-in-c-code","singleton-design-pattern-in-c-example","singleton-design-pattern-in-c-reference","singleton-design-pattern-in-c-simple-example","singleton-design-pattern-in-c-with-example","singleton-design-pattern-in-cpp","singleton-design-pattern-in-modern-c","singleton-design-pattern-program-c","singleton-design-pattern-with-dependency-injection","singleton-object-c","singleton-pattern-c-2","singleton-pattern-c","the-problem-of-testability-with-singleton","use-of-singleton-class-in-c","use-of-singleton-design-pattern-in-c","what-are-the-limitations-of-singleton-design-pattern-in-c","what-is-singleton-design-pattern-in-c","what-is-so-bad-about-the-singleton-design-pattern","what-is-the-correct-way-to-implement-singleton-design-pattern","what-is-the-use-of-singleton-design-pattern-in-c","when-should-you-use-the-singleton-design-pattern","why-singleton-design-pattern-in-c","why-we-use-singleton-design-pattern-in-c"],"articleBody":"In software engineering, Creational Design Patterns deal with object creation mechanisms, i.e. try to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. In this article of the Creational Design Patterns, we’re going to take a look at the much-hated \u0026 commonly asked design pattern in a programming interview. That is Singleton Design Pattern in Modern C++ which criticizes for its extensibility \u0026 testability. I will also cover the Multiton Design Pattern which quite contrary to Singleton.\nBy the way, If you haven’t check out my other articles on Creational Design Patterns, then here is the list:\nFactory Builder Prototype Singleton The code snippets you see throughout this series of articles are simplified not sophisticated. So you often see me not using keywords like override, final, public(while inheritance) just to make code compact \u0026 consumable(most of the time) in single standard screen size. I also prefer struct instead of class just to save line by not writing “public:” sometimes and also miss virtual destructor, constructor, copy constructor, prefix std::, deleting dynamic memory, intentionally. I also consider myself a pragmatic person who wants to convey an idea in the simplest way possible rather than the standard way or using Jargons.\nNote:\nIf you stumbled here directly, then I would suggest you go through What is design pattern? first, even if it is trivial. I believe it will encourage you to explore more on this topic. All of this code you encounter in this series of articles are compiled using C++20(though I have used Modern C++ features up to C++17 in most cases). So if you don’t have access to the latest compiler you can use https://wandbox.org/ which has preinstalled boost library as well. Intent To ensure one \u0026 only one instance of a class exist at any point in time.\nThe Singleton Design Pattern ensures that a class has only one instance and provides a global point of access to that instance. This is useful when exactly one object need to coordinate actions across the system. So, essentially, the Singleton Design Pattern is nothing more than specifying a lifetime. Singleton Design Pattern C++ Example The motivation for using a Singleton Design Pattern is fairly obvious. Some components in our system only need to have a single instance. For example, a database that loads up from its constructor into memory \u0026 then gives out information about its contents. Once it’s loaded up you don’t really want more than one instance of it because there is no point. And you also want to prevent your clients/API-users from making any additional copies of that object. Following is a trivial example of the Singleton Design Pattern in C++. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 /* country.txt Japan 1000000 India 2000000 America 123500 */ class SingletonDatabase { std::map\u003cstd::string, int32_t\u003e m_country; SingletonDatabase() { std::ifstream ifs(\"country.txt\"); std::string city, population; while (getline(ifs, city)) { getline(ifs, population); m_country[city] = stoi(population); } } public: SingletonDatabase(SingletonDatabase const \u0026) = delete; SingletonDatabase \u0026operator=(SingletonDatabase const \u0026) = delete; static SingletonDatabase \u0026get() { static SingletonDatabase db; return db; } int32_t get_population(const std::string \u0026name) { return m_country[name]; } }; int main() { SingletonDatabase::get().get_population(\"Japan\"); return EXIT_SUCCESS; } Some of the things to note here from the design perspective are:\nPrivate constructor\nDeleted copy constructor \u0026 copy assignment operator\nStatic object creation \u0026 static method to access\nThe Problem of Testability With Singleton So we have our Singleton database and let’s suppose that we decide to use this database to do some research and we actually made a new class called a SingletonRecordFinder which is going to find the total population from the collection of city names provided in the argument as follow. 1 2 3 4 5 6 7 8 struct SingletonRecordFinder { static int32_t total_population(const vector\u003cstring\u003e\u0026 countries) { int32_t result = 0; for (auto \u0026country : countries) result += SingletonDatabase::get().get_population(country); return result; } }; But let’s suppose that we decide that we want to test the SingletonRecordFinder and this is where all the problems show up. 1 2 vector\u003cstring\u003e countries= {\"Japan\", \"India\"}; // Strongly tied to data base entries TEST(1000000 + 2000000, SingletonRecordFinder::total_population(countries)); Unfortunately, because we are strongly tied to the real database and there is no way to substitute this database. I have to use the values taken from the actual file. And when later on these entries change, your test will start failing as you may have not updated the code. And this going to be a continuous problem. Moreover, this is not going to be a unit-test rather it is integration test as we are not only testing our code but also a production database which is not good design. Surely there is a better way of actually implementing this particular construct so that we can still use the singleton but if need we can supply an alternative to the singleton implementation with some dummy data of our own. Singleton Design Pattern With Dependency Injection The problem that we’re encountering in the testing of the SingletonRecordFinder is to do with the fact that we have a dependency upon essentially the details of how a database provides its data because we’re depending directly on the singleton database and the fact that it’s a singleton. So why don’t we use a little bit of dependency injection on an interface or abstract class! 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 struct Database { // Dependency virtual int32_t get_population(const string\u0026 country) = 0; }; class SingletonDatabase : Database { map\u003cstring, int32_t\u003e m_countries; SingletonDatabase() { ifstream ifs(\"countries.txt\"); string city, population; while (getline(ifs, city)) { getline(ifs, population); m_countries[city] = stoi(population); } } public: SingletonDatabase(SingletonDatabase const \u0026) = delete; SingletonDatabase \u0026operator=(SingletonDatabase const \u0026) = delete; static SingletonDatabase \u0026get() { static SingletonDatabase db; return db; } int32_t get_population(const string \u0026country) { return m_countries[country]; } }; class DummyDatabase : public Database { map\u003cstring, int32_t\u003e m_countries; public: DummyDatabase() : m_countries{{\"alpha\", 1}, {\"beta\", 2}, {\"gamma\", 3}} {} int32_t get_population(const string \u0026country) { return m_countries[country]; } }; /* Testing class ------------------------------------------------------------ */ class ConfigurableRecordFinder { Database\u0026 m_db; // Dependency Injection public: ConfigurableRecordFinder(Database \u0026db) : m_db{db} {} int32_t total_population(const vector\u003cstring\u003e \u0026countries) { int32_t result = 0; for (auto \u0026country : countries) result += m_db.get_population(country); return result; } }; /* ------------------------------------------------------------------------- */ int main() { DummyDatabase db; ConfigurableRecordFinder rf(db); rf.total_population({\"Japan\", \"India\", \"America\"}); return EXIT_SUCCESS; } Due to Dependency Injection i.e. Database interface, our both following issues are resolved: We have done a proper unit test rather an integration test, Now our testing class is not directly tie-up to Singleton. So no need to change our unit-test over \u0026 over in accordance with a database change. Multiton Design Pattern Multiton is a variation to singleton but not directly linked to it. Remember that singleton prevents you to have additional instances while Multiton Design Pattern sets up kind of key-value pair along with the limitation for the number of instance creation. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 enum class Importance { PRIMARY, SECONDARY, TERTIARY }; template \u003ctypename T, typename Key = std::string\u003e struct Multiton { static shared_ptr\u003cT\u003e get(const Key \u0026key) { if (const auto it = m_instances.find(key); it != m_instances.end()) { // C++17 return it-\u003esecond; } return m_instances[key] = make_shared\u003cT\u003e(); } private: static map\u003cKey, shared_ptr\u003cT\u003e\u003e m_instances; }; template \u003ctypename T, typename Key\u003e map\u003cKey, shared_ptr\u003cT\u003e\u003e Multiton\u003cT, Key\u003e::m_instances; // Just initialization of static data member struct Printer { Printer() { cout \u003c\u003c \"Total instances so far = \" \u003c\u003c ++InstCnt \u003c\u003c endl; } private: static int InstCnt; }; int Printer::InstCnt = 0; int main() { using mt = Multiton\u003cPrinter, Importance\u003e; auto main = mt::get(Importance::PRIMARY); auto aux = mt::get(Importance::SECONDARY); auto aux2 = mt::get(Importance::SECONDARY); // Will not create additional instances return EXIT_SUCCESS; } So as you can see we have three printers i.e. primary, secondary \u0026 tertiary whose access \u0026 instantiation is controlled by Multiton. Rest of the code is self-explanatory I hope. Benefits of Singleton Design Pattern The Singleton Design Pattern is quite helpful for application configurations as configurations may need to be accessible globally, and future expansions to the application configurations can be consolidated at single place. A second common use of this class is in updating old code to work in a new architecture. Since developers may have used globals liberally, moving them into a single class and making it a singleton, can be an intermediary step to bring the program inline to the stronger object-oriented structure. Singleton Design Pattern also enhance the maintainability as it provides a single point of access to a particular instance. Summary by FAQs What is so bad about the Singleton Design Pattern?\nSingleton object holds the state for the lifetime of the application. Which is bad for testing since you can end up with a situation where tests need to be ordered which is a big no-no for unit tests. Why? Because each unit test should be independent of the other. Singleton object causes code to be tightly coupled. This makes guessing the expected result under test scenarios rather difficult as we have seen above in database example. But you can overcome it by using Dependency Injection along with Singleton Design Pattern. Imagine the situation where you have a concurrent application accessing Singleton object from every part of your application, It just mashes up things or slows it down if you use a mutex or any other synchronization primitives. What is the correct way to implement Singleton Design Pattern?\nThe right way to implement Singleton is by dependency injection, So instead of directly depending on a singleton, you might want to consider it depending on an abstraction(e.g. an interface). I would also encourage you to use synchronization primitives(like a mutex, semaphores, etc) to control access.\nWhen should you use the Singleton Design Pattern?\nUsually, Singleton is used in hardware interface usage limitation. For example, Printers are limited in numbers, so in such case, a singleton or multiton design pattern is used to manage access. Singleton Design Pattern is also widely employed in managing configuration or properties file to manage access. We can use the cache as a singleton object as it can have a global point of reference and for all future calls to the cache object, the client application will use the in-memory object. ","wordCount":"1810","inLanguage":"en","image":"http://localhost:1313/images/Singleton-Design-Pattern-in-Modern-C-vishal-chovatiya.png","datePublished":"2020-04-06T00:00:00Z","dateModified":"2020-04-06T00:00:00Z","author":{"@type":"Person","name":"Vishal Chovatiya"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/singleton-design-pattern-in-modern-cpp/"},"publisher":{"@type":"Organization","name":"Vishal Chovatiya","logo":{"@type":"ImageObject","url":"http://localhost:1313/images/trident_favicon.webp"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Vishal Chovatiya (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Vishal Chovatiya</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/pages/vishal-chovatiya title="About Me"><span>About Me</span></a></li><li><a href=http://localhost:1313/pages/start-here title="Start Here"><span>Start Here</span></a></li><li><a href=http://localhost:1313/posts/ title=Latest><span>Latest</span></a></li><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Singleton Design Pattern in Modern C++</h1><div class=post-meta><span title='2020-04-06 00:00:00 +0000 UTC'>April 6, 2020</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1810 words&nbsp;·&nbsp;Vishal Chovatiya&nbsp;|&nbsp;<a href=https://github.com/vishalchovatiya/blog/blob/main/vishalchovatiya/content/posts/singleton-design-pattern-in-modern-cpp.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=http://localhost:1313/images/Singleton-Design-Pattern-in-Modern-C-vishal-chovatiya.png alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#intent>Intent</a></li><li><a href=#singleton-design-pattern-c-example>Singleton Design Pattern C++ Example</a></li><li><a href=#the-problem-of-testability-with-singleton>The Problem of Testability With Singleton</a></li><li><a href=#singleton-design-pattern-with-dependency-injection>Singleton Design Pattern With Dependency Injection</a></li><li><a href=#multiton-design-pattern>Multiton Design Pattern</a></li><li><a href=#benefits-of-singleton-design-pattern>Benefits of Singleton Design Pattern</a></li><li><a href=#summary-by-faqs>Summary by FAQs</a></li></ul></nav></div></details></div><div class=post-content><p>In software engineering, Creational Design Patterns deal with object creation mechanisms, i.e. try to create objects in a manner suitable to the situation. The basic or ordinary form of object creation could result in design problems or added complexity to the design. In this article of the Creational Design Patterns, we&rsquo;re going to take a look at the much-hated & commonly asked design pattern in a programming interview. That is Singleton Design Pattern in Modern C++ which criticizes for its extensibility & testability. I will also cover the Multiton Design Pattern which quite contrary to Singleton.</p><p>By the way, If you haven’t check out my other articles on Creational Design Patterns, then here is the list:</p><ol><li><a href=/posts//factory-design-pattern-in-modern-cpp/>Factory</a></li><li><a href=/posts//builder-design-pattern-in-modern-cpp/>Builder</a></li><li><a href=/posts//prototype-design-pattern-in-modern-cpp/>Prototype</a></li><li><a href=/posts//singleton-design-pattern-in-modern-cpp/>Singleton</a></li></ol><p>The code snippets you see throughout this series of articles are simplified not sophisticated. So you often see me not using keywords like <code>override</code>, <code>final</code>, <code>public</code>(while inheritance) just to make code compact & consumable(most of the time) in single standard screen size. I also prefer <code>struct</code> instead of <code>class</code> just to save line by not writing &ldquo;<code>public:</code>&rdquo; sometimes and also miss <a href=/posts//part-3-all-about-virtual-keyword-in-c-how-virtual-destructor-works/>virtual destructor</a>, constructor, <a href=/posts//all-about-copy-constructor-in-cpp-with-example/>copy constructor</a>, prefix <code>std::</code>, deleting dynamic memory, intentionally. I also consider myself a pragmatic person who wants to convey an idea in the simplest way possible rather than the standard way or using Jargons.</p><p><strong><em>Note:</em></strong></p><ul><li>If you stumbled here directly, then I would suggest you go through <a href=/posts//what-is-design-pattern/>What is design pattern?</a> first, even if it is trivial. I believe it will encourage you to explore more on this topic.</li><li>All of this code you encounter in this series of articles are compiled using C++20(though I have used <a href=/posts//21-new-features-of-modern-cpp-to-use-in-your-project/>Modern C++</a> features up to C++17 in most cases). So if you don&rsquo;t have access to the latest compiler you can use <a href=https://wandbox.org/>https://wandbox.org/</a> which has preinstalled boost library as well.</li></ul><h2 id=intent>Intent<a hidden class=anchor aria-hidden=true href=#intent>#</a></h2><blockquote><p><strong><em>To ensure one & only one instance of a class exist at any point in time.</em></strong></p></blockquote><ul><li>The Singleton Design Pattern ensures that a class has only one instance and provides a global point of access to that instance. This is useful when exactly one object need to coordinate actions across the system.</li><li>So, essentially, the Singleton Design Pattern is nothing more than specifying a lifetime.</li></ul><h2 id=singleton-design-pattern-c-example>Singleton Design Pattern C++ Example<a hidden class=anchor aria-hidden=true href=#singleton-design-pattern-c-example>#</a></h2><ul><li>The motivation for using a Singleton Design Pattern is fairly obvious. Some components in our system only need to have a single instance. For example, a database that loads up from its constructor into memory & then gives out information about its contents. Once it&rsquo;s loaded up you don&rsquo;t really want more than one instance of it because there is no point.</li><li>And you also want to prevent your clients/API-users from making any additional copies of that <a href=/posts/inside-the-cpp-object-model/>object</a>. Following is a trivial example of the Singleton Design Pattern in C++.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33>33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34>34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35>35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36>36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37>37</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cm>/* country.txt 
</span></span></span><span class=line><span class=cl><span class=cm>Japan
</span></span></span><span class=line><span class=cl><span class=cm>1000000
</span></span></span><span class=line><span class=cl><span class=cm>India
</span></span></span><span class=line><span class=cl><span class=cm>2000000
</span></span></span><span class=line><span class=cl><span class=cm>America
</span></span></span><span class=line><span class=cl><span class=cm>123500
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SingletonDatabase</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>map</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>,</span> <span class=kt>int32_t</span><span class=o>&gt;</span>  <span class=n>m_country</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>SingletonDatabase</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>std</span><span class=o>::</span><span class=n>ifstream</span> <span class=n>ifs</span><span class=p>(</span><span class=s>&#34;country.txt&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>city</span><span class=p>,</span> <span class=n>population</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=n>getline</span><span class=p>(</span><span class=n>ifs</span><span class=p>,</span> <span class=n>city</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>getline</span><span class=p>(</span><span class=n>ifs</span><span class=p>,</span> <span class=n>population</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>m_country</span><span class=p>[</span><span class=n>city</span><span class=p>]</span> <span class=o>=</span> <span class=n>stoi</span><span class=p>(</span><span class=n>population</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>SingletonDatabase</span><span class=p>(</span><span class=n>SingletonDatabase</span> <span class=k>const</span> <span class=o>&amp;</span><span class=p>)</span> <span class=o>=</span> <span class=k>delete</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>SingletonDatabase</span> <span class=o>&amp;</span><span class=k>operator</span><span class=o>=</span><span class=p>(</span><span class=n>SingletonDatabase</span> <span class=k>const</span> <span class=o>&amp;</span><span class=p>)</span> <span class=o>=</span> <span class=k>delete</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=n>SingletonDatabase</span> <span class=o>&amp;</span><span class=n>get</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>static</span> <span class=n>SingletonDatabase</span> <span class=n>db</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>db</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int32_t</span> <span class=nf>get_population</span><span class=p>(</span><span class=k>const</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=o>&amp;</span><span class=n>name</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=n>m_country</span><span class=p>[</span><span class=n>name</span><span class=p>];</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SingletonDatabase</span><span class=o>::</span><span class=n>get</span><span class=p>().</span><span class=n>get_population</span><span class=p>(</span><span class=s>&#34;Japan&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><p>Some of the things to note here from the design perspective are:</p><ul><li><p>Private constructor</p></li><li><p>Deleted <a href=/posts/all-about-copy-constructor-in-cpp-with-example/>copy constructor</a> & <a href=/posts/2-wrong-way-to-learn-copy-assignment-operator-in-cpp-with-example/>copy assignment operator</a></p></li><li><p>Static object creation & static method to access</p></li></ul></li></ul><h2 id=the-problem-of-testability-with-singleton>The Problem of Testability With Singleton<a hidden class=anchor aria-hidden=true href=#the-problem-of-testability-with-singleton>#</a></h2><ul><li>So we have our Singleton database and let&rsquo;s suppose that we decide to use this database to do some research and we actually made a new class called a <code>SingletonRecordFinder</code> which is going to find the total population from the collection of city names provided in the argument as follow.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7>7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>struct</span> <span class=nc>SingletonRecordFinder</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=kt>int32_t</span> <span class=nf>total_population</span><span class=p>(</span><span class=k>const</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;&amp;</span>   <span class=n>countries</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int32_t</span> <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=o>&amp;</span><span class=nl>country</span> <span class=p>:</span> <span class=n>countries</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>+=</span> <span class=n>SingletonDatabase</span><span class=o>::</span><span class=n>get</span><span class=p>().</span><span class=n>get_population</span><span class=p>(</span><span class=n>country</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>But let&rsquo;s suppose that we decide that we want to test the <code>SingletonRecordFinder</code> and this is where all the problems show up.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;</span> <span class=n>countries</span><span class=o>=</span> <span class=p>{</span><span class=s>&#34;Japan&#34;</span><span class=p>,</span> <span class=s>&#34;India&#34;</span><span class=p>};</span> <span class=c1>// Strongly tied to data base entries
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>TEST</span><span class=p>(</span><span class=mi>1000000</span> <span class=o>+</span> <span class=mi>2000000</span><span class=p>,</span> <span class=n>SingletonRecordFinder</span><span class=o>::</span><span class=n>total_population</span><span class=p>(</span><span class=n>countries</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Unfortunately, because we are strongly tied to the real database and there is no way to substitute this database. I have to use the values taken from the actual file. And when later on these entries change, your test will start failing as you may have not updated the code. And this going to be a continuous problem.</li><li>Moreover, this is not going to be a unit-test rather it is integration test as we are not only testing our code but also a production database which is not good design.</li><li>Surely there is a better way of actually implementing this particular construct so that we can still use the singleton but if need we can supply an alternative to the singleton implementation with some dummy data of our own.</li></ul><h2 id=singleton-design-pattern-with-dependency-injection>Singleton Design Pattern With Dependency Injection<a hidden class=anchor aria-hidden=true href=#singleton-design-pattern-with-dependency-injection>#</a></h2><ul><li>The problem that we&rsquo;re encountering in the testing of the <code>SingletonRecordFinder</code> is to do with the fact that we have a dependency upon essentially the details of how a database provides its data because we&rsquo;re depending directly on the singleton database and the fact that it&rsquo;s a singleton.</li><li>So why don&rsquo;t we use a little bit of <a href=https://en.wikipedia.org/wiki/Dependency_injection>dependency injection</a> on an interface or abstract class!</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24>24</a>
</span><span class=lnt id=hl-3-25><a class=lnlinks href=#hl-3-25>25</a>
</span><span class=lnt id=hl-3-26><a class=lnlinks href=#hl-3-26>26</a>
</span><span class=lnt id=hl-3-27><a class=lnlinks href=#hl-3-27>27</a>
</span><span class=lnt id=hl-3-28><a class=lnlinks href=#hl-3-28>28</a>
</span><span class=lnt id=hl-3-29><a class=lnlinks href=#hl-3-29>29</a>
</span><span class=lnt id=hl-3-30><a class=lnlinks href=#hl-3-30>30</a>
</span><span class=lnt id=hl-3-31><a class=lnlinks href=#hl-3-31>31</a>
</span><span class=lnt id=hl-3-32><a class=lnlinks href=#hl-3-32>32</a>
</span><span class=lnt id=hl-3-33><a class=lnlinks href=#hl-3-33>33</a>
</span><span class=lnt id=hl-3-34><a class=lnlinks href=#hl-3-34>34</a>
</span><span class=lnt id=hl-3-35><a class=lnlinks href=#hl-3-35>35</a>
</span><span class=lnt id=hl-3-36><a class=lnlinks href=#hl-3-36>36</a>
</span><span class=lnt id=hl-3-37><a class=lnlinks href=#hl-3-37>37</a>
</span><span class=lnt id=hl-3-38><a class=lnlinks href=#hl-3-38>38</a>
</span><span class=lnt id=hl-3-39><a class=lnlinks href=#hl-3-39>39</a>
</span><span class=lnt id=hl-3-40><a class=lnlinks href=#hl-3-40>40</a>
</span><span class=lnt id=hl-3-41><a class=lnlinks href=#hl-3-41>41</a>
</span><span class=lnt id=hl-3-42><a class=lnlinks href=#hl-3-42>42</a>
</span><span class=lnt id=hl-3-43><a class=lnlinks href=#hl-3-43>43</a>
</span><span class=lnt id=hl-3-44><a class=lnlinks href=#hl-3-44>44</a>
</span><span class=lnt id=hl-3-45><a class=lnlinks href=#hl-3-45>45</a>
</span><span class=lnt id=hl-3-46><a class=lnlinks href=#hl-3-46>46</a>
</span><span class=lnt id=hl-3-47><a class=lnlinks href=#hl-3-47>47</a>
</span><span class=lnt id=hl-3-48><a class=lnlinks href=#hl-3-48>48</a>
</span><span class=lnt id=hl-3-49><a class=lnlinks href=#hl-3-49>49</a>
</span><span class=lnt id=hl-3-50><a class=lnlinks href=#hl-3-50>50</a>
</span><span class=lnt id=hl-3-51><a class=lnlinks href=#hl-3-51>51</a>
</span><span class=lnt id=hl-3-52><a class=lnlinks href=#hl-3-52>52</a>
</span><span class=lnt id=hl-3-53><a class=lnlinks href=#hl-3-53>53</a>
</span><span class=lnt id=hl-3-54><a class=lnlinks href=#hl-3-54>54</a>
</span><span class=lnt id=hl-3-55><a class=lnlinks href=#hl-3-55>55</a>
</span><span class=lnt id=hl-3-56><a class=lnlinks href=#hl-3-56>56</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>struct</span> <span class=nc>Database</span> <span class=p>{</span> <span class=c1>// Dependency 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>virtual</span> <span class=kt>int32_t</span> <span class=nf>get_population</span><span class=p>(</span><span class=k>const</span> <span class=n>string</span><span class=o>&amp;</span> <span class=n>country</span><span class=p>)</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SingletonDatabase</span> <span class=o>:</span> <span class=n>Database</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=kt>int32_t</span><span class=o>&gt;</span>    <span class=n>m_countries</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>SingletonDatabase</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ifstream</span> <span class=nf>ifs</span><span class=p>(</span><span class=s>&#34;countries.txt&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>string</span> <span class=n>city</span><span class=p>,</span> <span class=n>population</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=n>getline</span><span class=p>(</span><span class=n>ifs</span><span class=p>,</span> <span class=n>city</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>getline</span><span class=p>(</span><span class=n>ifs</span><span class=p>,</span> <span class=n>population</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>m_countries</span><span class=p>[</span><span class=n>city</span><span class=p>]</span> <span class=o>=</span> <span class=n>stoi</span><span class=p>(</span><span class=n>population</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>SingletonDatabase</span><span class=p>(</span><span class=n>SingletonDatabase</span> <span class=k>const</span> <span class=o>&amp;</span><span class=p>)</span> <span class=o>=</span> <span class=k>delete</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>SingletonDatabase</span> <span class=o>&amp;</span><span class=k>operator</span><span class=o>=</span><span class=p>(</span><span class=n>SingletonDatabase</span> <span class=k>const</span> <span class=o>&amp;</span><span class=p>)</span> <span class=o>=</span> <span class=k>delete</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=n>SingletonDatabase</span> <span class=o>&amp;</span><span class=n>get</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>static</span> <span class=n>SingletonDatabase</span> <span class=n>db</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>db</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int32_t</span> <span class=nf>get_population</span><span class=p>(</span><span class=k>const</span> <span class=n>string</span> <span class=o>&amp;</span><span class=n>country</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=n>m_countries</span><span class=p>[</span><span class=n>country</span><span class=p>];</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DummyDatabase</span> <span class=o>:</span> <span class=k>public</span> <span class=n>Database</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>map</span><span class=o>&lt;</span><span class=n>string</span><span class=p>,</span> <span class=kt>int32_t</span><span class=o>&gt;</span>    <span class=n>m_countries</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>DummyDatabase</span><span class=p>()</span> <span class=o>:</span> <span class=n>m_countries</span><span class=p>{{</span><span class=s>&#34;alpha&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>},</span> <span class=p>{</span><span class=s>&#34;beta&#34;</span><span class=p>,</span> <span class=mi>2</span><span class=p>},</span> <span class=p>{</span><span class=s>&#34;gamma&#34;</span><span class=p>,</span> <span class=mi>3</span><span class=p>}}</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=kt>int32_t</span> <span class=nf>get_population</span><span class=p>(</span><span class=k>const</span> <span class=n>string</span> <span class=o>&amp;</span><span class=n>country</span><span class=p>)</span> <span class=p>{</span> <span class=k>return</span> <span class=n>m_countries</span><span class=p>[</span><span class=n>country</span><span class=p>];</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* Testing class ------------------------------------------------------------ */</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ConfigurableRecordFinder</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Database</span><span class=o>&amp;</span>       <span class=n>m_db</span><span class=p>;</span>  <span class=c1>// Dependency Injection
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ConfigurableRecordFinder</span><span class=p>(</span><span class=n>Database</span> <span class=o>&amp;</span><span class=n>db</span><span class=p>)</span> <span class=o>:</span> <span class=n>m_db</span><span class=p>{</span><span class=n>db</span><span class=p>}</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=kt>int32_t</span> <span class=nf>total_population</span><span class=p>(</span><span class=k>const</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>countries</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int32_t</span> <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=o>&amp;</span><span class=nl>country</span> <span class=p>:</span> <span class=n>countries</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>+=</span> <span class=n>m_db</span><span class=p>.</span><span class=n>get_population</span><span class=p>(</span><span class=n>country</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=cm>/* ------------------------------------------------------------------------- */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>DummyDatabase</span> <span class=n>db</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ConfigurableRecordFinder</span> <span class=n>rf</span><span class=p>(</span><span class=n>db</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>rf</span><span class=p>.</span><span class=n>total_population</span><span class=p>({</span><span class=s>&#34;Japan&#34;</span><span class=p>,</span> <span class=s>&#34;India&#34;</span><span class=p>,</span> <span class=s>&#34;America&#34;</span><span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Due to Dependency Injection i.e. <code>Database</code> interface, our both following issues are resolved:<ol><li>We have done a proper unit test rather an integration test,</li><li>Now our testing class is not directly tie-up to Singleton. So no need to change our unit-test over & over in accordance with a database change.</li></ol></li></ul><h2 id=multiton-design-pattern>Multiton Design Pattern<a hidden class=anchor aria-hidden=true href=#multiton-design-pattern>#</a></h2><ul><li>Multiton is a variation to singleton but not directly linked to it. Remember that singleton prevents you to have additional instances while Multiton Design Pattern sets up kind of key-value pair along with the limitation for the number of instance creation.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span><span class=lnt id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a>
</span><span class=lnt id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a>
</span><span class=lnt id=hl-4-25><a class=lnlinks href=#hl-4-25>25</a>
</span><span class=lnt id=hl-4-26><a class=lnlinks href=#hl-4-26>26</a>
</span><span class=lnt id=hl-4-27><a class=lnlinks href=#hl-4-27>27</a>
</span><span class=lnt id=hl-4-28><a class=lnlinks href=#hl-4-28>28</a>
</span><span class=lnt id=hl-4-29><a class=lnlinks href=#hl-4-29>29</a>
</span><span class=lnt id=hl-4-30><a class=lnlinks href=#hl-4-30>30</a>
</span><span class=lnt id=hl-4-31><a class=lnlinks href=#hl-4-31>31</a>
</span><span class=lnt id=hl-4-32><a class=lnlinks href=#hl-4-32>32</a>
</span><span class=lnt id=hl-4-33><a class=lnlinks href=#hl-4-33>33</a>
</span><span class=lnt id=hl-4-34><a class=lnlinks href=#hl-4-34>34</a>
</span><span class=lnt id=hl-4-35><a class=lnlinks href=#hl-4-35>35</a>
</span><span class=lnt id=hl-4-36><a class=lnlinks href=#hl-4-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>Importance</span> <span class=p>{</span> <span class=n>PRIMARY</span><span class=p>,</span> <span class=n>SECONDARY</span><span class=p>,</span> <span class=n>TERTIARY</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=n>T</span><span class=p>,</span> <span class=k>typename</span> <span class=n>Key</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>Multiton</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=n>shared_ptr</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=n>get</span><span class=p>(</span><span class=k>const</span> <span class=n>Key</span> <span class=o>&amp;</span><span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=k>const</span> <span class=k>auto</span> <span class=n>it</span> <span class=o>=</span> <span class=n>m_instances</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>key</span><span class=p>);</span> <span class=n>it</span> <span class=o>!=</span> <span class=n>m_instances</span><span class=p>.</span><span class=n>end</span><span class=p>())</span> <span class=p>{</span> <span class=c1>// C++17
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>return</span> <span class=n>it</span><span class=o>-&gt;</span><span class=n>second</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>m_instances</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>make_shared</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=n>map</span><span class=o>&lt;</span><span class=n>Key</span><span class=p>,</span> <span class=n>shared_ptr</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&gt;</span>  <span class=n>m_instances</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=n>T</span><span class=p>,</span> <span class=k>typename</span> <span class=n>Key</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=n>map</span><span class=o>&lt;</span><span class=n>Key</span><span class=p>,</span> <span class=n>shared_ptr</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&gt;</span>     <span class=n>Multiton</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span> <span class=n>Key</span><span class=o>&gt;::</span><span class=n>m_instances</span><span class=p>;</span> <span class=c1>// Just initialization of static data member
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>Printer</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Printer</span><span class=p>()</span> <span class=p>{</span> <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Total instances so far = &#34;</span> <span class=o>&lt;&lt;</span> <span class=o>++</span><span class=n>InstCnt</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=kt>int</span> <span class=n>InstCnt</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>Printer</span><span class=o>::</span><span class=n>InstCnt</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>using</span> <span class=n>mt</span> <span class=o>=</span> <span class=n>Multiton</span><span class=o>&lt;</span><span class=n>Printer</span><span class=p>,</span> <span class=n>Importance</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=n>main</span> <span class=o>=</span> <span class=n>mt</span><span class=o>::</span><span class=n>get</span><span class=p>(</span><span class=n>Importance</span><span class=o>::</span><span class=n>PRIMARY</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=n>aux</span> <span class=o>=</span> <span class=n>mt</span><span class=o>::</span><span class=n>get</span><span class=p>(</span><span class=n>Importance</span><span class=o>::</span><span class=n>SECONDARY</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=n>aux2</span> <span class=o>=</span> <span class=n>mt</span><span class=o>::</span><span class=n>get</span><span class=p>(</span><span class=n>Importance</span><span class=o>::</span><span class=n>SECONDARY</span><span class=p>);</span> <span class=c1>// Will not create additional instances
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>So as you can see we have three printers i.e. primary, secondary & tertiary whose access & instantiation is controlled by <code>Multiton</code>. Rest of the code is self-explanatory I hope.</li></ul><h2 id=benefits-of-singleton-design-pattern>Benefits of Singleton Design Pattern<a hidden class=anchor aria-hidden=true href=#benefits-of-singleton-design-pattern>#</a></h2><ol><li>The Singleton Design Pattern is quite helpful for application configurations as configurations may need to be accessible globally, and future expansions to the application configurations can be consolidated at single place.</li><li>A second common use of this class is in updating old code to work in a new architecture. Since developers may have used globals liberally, moving them into a single class and making it a singleton, can be an intermediary step to bring the program inline to the stronger object-oriented structure.</li><li>Singleton Design Pattern also enhance the maintainability as it provides a single point of access to a particular instance.</li></ol><h2 id=summary-by-faqs>Summary by FAQs<a hidden class=anchor aria-hidden=true href=#summary-by-faqs>#</a></h2><p><strong>What is so bad about the Singleton Design Pattern?</strong></p><ul><li>Singleton object holds the state for the lifetime of the application. Which is bad for testing since you can end up with a situation where tests need to be ordered which is a big no-no for unit tests. Why? Because each unit test should be independent of the other.</li><li>Singleton object causes code to be tightly coupled. This makes guessing the expected result under test scenarios rather difficult as we have seen above in database example. But you can overcome it by using Dependency Injection along with Singleton Design Pattern.</li><li>Imagine the situation where you have a concurrent application accessing Singleton object from every part of your application, It just mashes up things or slows it down if you use a mutex or any other synchronization primitives.</li></ul><p><strong>What is the correct way to implement Singleton Design Pattern?</strong></p><p>The right way to implement Singleton is by dependency injection, So instead of directly depending on a singleton, you might want to consider it depending on an abstraction(e.g. an interface). I would also encourage you to use synchronization primitives(like a mutex, semaphores, etc) to control access.</p><p><strong>When should you use the Singleton Design Pattern?</strong></p><ul><li>Usually, Singleton is used in hardware interface usage limitation. For example, Printers are limited in numbers, so in such case, a singleton or multiton design pattern is used to manage access.</li><li>Singleton Design Pattern is also widely employed in managing configuration or properties file to manage access.</li><li>We can use the cache as a singleton object as it can have a global point of reference and for all future calls to the cache object, the client application will use the in-memory <a href=/posts/memory-layout-of-cpp-object/>object</a>.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/benefits-of-singleton-design-pattern/>Benefits-of-Singleton-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/c-class-singleton/>C-Class-Singleton</a></li><li><a href=http://localhost:1313/tags/c-singleton/>C-Singleton</a></li><li><a href=http://localhost:1313/tags/c-singleton-class-example/>C-Singleton-Class-Example</a></li><li><a href=http://localhost:1313/tags/c-singleton-design-pattern/>C-Singleton-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/c-singleton-example/>C-Singleton-Example</a></li><li><a href=http://localhost:1313/tags/c-singleton-implementation/>C-Singleton-Implementation</a></li><li><a href=http://localhost:1313/tags/c-singleton-pattern-example/>C-Singleton-Pattern-Example</a></li><li><a href=http://localhost:1313/tags/c-singleton-template/>C-Singleton-Template</a></li><li><a href=http://localhost:1313/tags/cpp-singleton/>Cpp-Singleton</a></li><li><a href=http://localhost:1313/tags/design-patterns-singleton-c-destructor/>Design-Patterns-Singleton-C-Destructor</a></li><li><a href=http://localhost:1313/tags/example-of-singleton-design-pattern-in-c/>Example-of-Singleton-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/how-to-implement-singleton-design-pattern-in-c/>How-to-Implement-Singleton-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/multiton-design-pattern/>Multiton-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/real-time-example-of-singleton-class-in-c/>Real-Time-Example-of-Singleton-Class-in-C</a></li><li><a href=http://localhost:1313/tags/real-time-example-of-singleton-design-pattern-in-c/>Real-Time-Example-of-Singleton-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/singleton-c-class/>Singleton-C-Class</a></li><li><a href=http://localhost:1313/tags/singleton-c-example/>Singleton-C-Example</a></li><li><a href=http://localhost:1313/tags/singleton-class-c/>Singleton-Class-C</a></li><li><a href=http://localhost:1313/tags/singleton-class-c-example/>Singleton-Class-C-Example</a></li><li><a href=http://localhost:1313/tags/singleton-class-design-pattern-in-c/>Singleton-Class-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/singleton-class-example-in-c/>Singleton-Class-Example-in-C</a></li><li><a href=http://localhost:1313/tags/singleton-class-in-cpp/>Singleton-Class-in-Cpp</a></li><li><a href=http://localhost:1313/tags/singleton-constructor-c/>Singleton-Constructor-C</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-c-11/>Singleton-Design-Pattern-C-11</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-c-copy-constructor/>Singleton-Design-Pattern-C-Copy-Constructor</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-c-implementation/>Singleton-Design-Pattern-C-Implementation</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-c-inheritance/>Singleton-Design-Pattern-C-Inheritance</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-c-tutorial/>Singleton-Design-Pattern-C-Tutorial</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-examples-in-c/>Singleton-Design-Pattern-Examples-in-C</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-in-c/>Singleton-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-in-c-code/>Singleton-Design-Pattern-in-C-Code</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-in-c-example/>Singleton-Design-Pattern-in-C-Example</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-in-c-reference/>Singleton-Design-Pattern-in-C-Reference</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-in-c-simple-example/>Singleton-Design-Pattern-in-C-Simple-Example</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-in-c-with-example/>Singleton-Design-Pattern-in-C-With-Example</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-in-cpp/>Singleton-Design-Pattern-in-Cpp</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-in-modern-c/>Singleton-Design-Pattern-in-Modern-C</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-program-c/>Singleton-Design-Pattern-Program-C</a></li><li><a href=http://localhost:1313/tags/singleton-design-pattern-with-dependency-injection/>Singleton-Design-Pattern-With-Dependency-Injection</a></li><li><a href=http://localhost:1313/tags/singleton-object-c/>Singleton-Object-C</a></li><li><a href=http://localhost:1313/tags/singleton-pattern-c-2/>Singleton-Pattern-C-2</a></li><li><a href=http://localhost:1313/tags/singleton-pattern-c/>Singleton-Pattern-C</a></li><li><a href=http://localhost:1313/tags/the-problem-of-testability-with-singleton/>The-Problem-of-Testability-With-Singleton</a></li><li><a href=http://localhost:1313/tags/use-of-singleton-class-in-c/>Use-of-Singleton-Class-in-C</a></li><li><a href=http://localhost:1313/tags/use-of-singleton-design-pattern-in-c/>Use-of-Singleton-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/what-are-the-limitations-of-singleton-design-pattern-in-c/>What-Are-the-Limitations-of-Singleton-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/what-is-singleton-design-pattern-in-c/>What-Is-Singleton-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/what-is-so-bad-about-the-singleton-design-pattern/>What-Is-So-Bad-About-the-Singleton-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/what-is-the-correct-way-to-implement-singleton-design-pattern/>What-Is-the-Correct-Way-to-Implement-Singleton-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/what-is-the-use-of-singleton-design-pattern-in-c/>What-Is-the-Use-of-Singleton-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/when-should-you-use-the-singleton-design-pattern/>When-Should-You-Use-the-Singleton-Design-Pattern</a></li><li><a href=http://localhost:1313/tags/why-singleton-design-pattern-in-c/>Why-Singleton-Design-Pattern-in-C</a></li><li><a href=http://localhost:1313/tags/why-we-use-singleton-design-pattern-in-c/>Why-We-Use-Singleton-Design-Pattern-in-C</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/prototype-design-pattern-in-modern-cpp/><span class=title>« Prev</span><br><span>Prototype Design Pattern in Modern C++</span>
</a><a class=next href=http://localhost:1313/posts/adapter-design-pattern-in-modern-cpp/><span class=title>Next »</span><br><span>Adapter Design Pattern in Modern C++</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Singleton Design Pattern in Modern C++ on x" href="https://x.com/intent/tweet/?text=Singleton%20Design%20Pattern%20in%20Modern%20C%2b%2b&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fsingleton-design-pattern-in-modern-cpp%2f&amp;hashtags=benefits-of-singleton-design-pattern%2cc-class-singleton%2cc-singleton%2cc-singleton-class-example%2cc-singleton-design-pattern%2cc-singleton-example%2cc-singleton-implementation%2cc-singleton-pattern-example%2cc-singleton-template%2ccpp-singleton%2cdesign-patterns-singleton-c-destructor%2cexample-of-singleton-design-pattern-in-c%2chow-to-implement-singleton-design-pattern-in-c%2cmultiton-design-pattern%2creal-time-example-of-singleton-class-in-c%2creal-time-example-of-singleton-design-pattern-in-c%2csingleton-c-class%2csingleton-c-example%2csingleton-class-c%2csingleton-class-c-example%2csingleton-class-design-pattern-in-c%2csingleton-class-example-in-c%2csingleton-class-in-cpp%2csingleton-constructor-c%2csingleton-design-pattern-c-11%2csingleton-design-pattern-c-copy-constructor%2csingleton-design-pattern-c-implementation%2csingleton-design-pattern-c-inheritance%2csingleton-design-pattern-c-tutorial%2csingleton-design-pattern-examples-in-c%2csingleton-design-pattern-in-c%2csingleton-design-pattern-in-c-code%2csingleton-design-pattern-in-c-example%2csingleton-design-pattern-in-c-reference%2csingleton-design-pattern-in-c-simple-example%2csingleton-design-pattern-in-c-with-example%2csingleton-design-pattern-in-cpp%2csingleton-design-pattern-in-modern-c%2csingleton-design-pattern-program-c%2csingleton-design-pattern-with-dependency-injection%2csingleton-object-c%2csingleton-pattern-c-2%2csingleton-pattern-c%2cthe-problem-of-testability-with-singleton%2cuse-of-singleton-class-in-c%2cuse-of-singleton-design-pattern-in-c%2cwhat-are-the-limitations-of-singleton-design-pattern-in-c%2cwhat-is-singleton-design-pattern-in-c%2cwhat-is-so-bad-about-the-singleton-design-pattern%2cwhat-is-the-correct-way-to-implement-singleton-design-pattern%2cwhat-is-the-use-of-singleton-design-pattern-in-c%2cwhen-should-you-use-the-singleton-design-pattern%2cwhy-singleton-design-pattern-in-c%2cwhy-we-use-singleton-design-pattern-in-c"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Singleton Design Pattern in Modern C++ on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fsingleton-design-pattern-in-modern-cpp%2f&amp;title=Singleton%20Design%20Pattern%20in%20Modern%20C%2b%2b&amp;summary=Singleton%20Design%20Pattern%20in%20Modern%20C%2b%2b&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fsingleton-design-pattern-in-modern-cpp%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Singleton Design Pattern in Modern C++ on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fsingleton-design-pattern-in-modern-cpp%2f&title=Singleton%20Design%20Pattern%20in%20Modern%20C%2b%2b"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Singleton Design Pattern in Modern C++ on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fsingleton-design-pattern-in-modern-cpp%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Singleton Design Pattern in Modern C++ on whatsapp" href="https://api.whatsapp.com/send?text=Singleton%20Design%20Pattern%20in%20Modern%20C%2b%2b%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fsingleton-design-pattern-in-modern-cpp%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Singleton Design Pattern in Modern C++ on telegram" href="https://telegram.me/share/url?text=Singleton%20Design%20Pattern%20in%20Modern%20C%2b%2b&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fsingleton-design-pattern-in-modern-cpp%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Singleton Design Pattern in Modern C++ on ycombinator" href="https://news.ycombinator.com/submitlink?t=Singleton%20Design%20Pattern%20in%20Modern%20C%2b%2b&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fsingleton-design-pattern-in-modern-cpp%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Vishal Chovatiya</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>